<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>
   Latbualuang iCARE+
  </title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&amp;display=swap" rel="stylesheet"/>
<style>
   body { font-family: 'Prompt', sans-serif; }

/* Ensure modal is always centered on all devices */
.modal {
  display: flex !important;
  justify-content: center;
  align-items: center;
  position: fixed;
  top: 0; left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.4); /* Optional: darken background */
  z-index: 1000;
}

.modal-content {
  background-color: #ffffff;
  margin: auto;
  padding: 20px;
  border: 1px solid #ccc;
  max-width: 90%;
  width: 100%;
  max-width: 600px;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
  </style>
<link href="https://fonts.googleapis.com/css2?family=Mitr&amp;display=swap" rel="stylesheet"/>
<style>
   .font-mitr { font-family: "Mitr", sans-serif; }
  </style>
<link href="https://fonts.googleapis.com/css2?family=Exo+2&amp;display=swap" rel="stylesheet"/>
<style>
   .font-exo2 { font-family: "Exo 2", sans-serif; }
  </style>
<link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/flatpickr">
</script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/th.js">
</script>
<style>
   input[type="file"] + label,
input[type="file"] {
  color: #60A5FA !important;
}

input[type="file"]::file-selector-button {
  display: none;
}

/* Center modal popup style */
.modal {
  display: flex !important;
  justify-content: center;
  align-items: center;
}

.modal-content {
  background-color: #ffffff;
  margin: auto;
  padding: 20px;
  border: 1px solid #ccc;
  width: 100%;
  max-width: 600px;
  border-radius: 10px;
}
  </style>

<style>
/* Emergency form file inputs: light blue text, white background, white frame */
#emergencyForm input[type="file"] {
  color: #60A5FA !important;          /* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏î" ‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡πâ‡∏≤‡∏≠‡πà‡∏≠‡∏ô */
  background-color: #FFFFFF !important; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
  border: 2px solid #FFFFFF !important; /* ‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
  padding: 0.5rem 0.75rem;              /* ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
  border-radius: 0.375rem;              /* ‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏á‡∏°‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏° */
}
/* Hide default button for consistency (already hidden, keep as safety) */
#emergencyForm input[type="file"]::file-selector-button {
  display: none;
}
</style>

</head>
<body class="bg-gradient-to-b from-blue-50 to-white font-sans text-gray-800">
<!-- Header -->
<header class="bg-blue-900 text-white px-6 py-3 flex items-center justify-between shadow-md f l e x - w r a p m d : f l e x - n o w r a p">
<div class="flex items-center space-x-4">
<img alt="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="h-10 sm:h-12 md:h-14" src="https://img5.pic.in.th/file/secure-sv1/2408f05cc396274b4.png"/>
<div>
<h1 class="text-base sm:text-lg md:text-xl font-bold leading-tight">
      ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡∏≤‡∏î‡∏ö‡∏±‡∏ß‡∏´‡∏•‡∏ß‡∏á‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤
     </h1>
<p class="text-xs sm:text-sm md:text-base">
      LATBUALUANGPAIROTEWITTAYA SCHOOL
     </p>
</div>
</div>
<div class="space-x-2 flex flex-col sm:flex-row space-y-2 sm:space-y-0 items-center">
<button class="bg-yellow-400 hover:bg-yellow-500 text-white px-3 py-1 rounded" onclick="document.getElementById('loginModal').classList.remove('hidden')">
     üîê Login
    </button>
<div class="relative inline-block text-left">
<button class="bg-white text-blue-900 border border-white px-3 py-1 rounded inline-flex items-center justify-center w-full" id="registerDropdownBtn">
      üë§ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‚ñæ
     </button>
<div class="hidden absolute right-0 mt-2 w-48 bg-white border rounded shadow z-50" id="dropdownMenu">
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-100" href="#" onclick="openModal('studentModal')">
       üë®‚Äçüéì ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
      </a>
<a class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-100" href="#" onclick="openModal('teacherModal')">
       üë®‚Äçüè´ ‡∏Ñ‡∏£‡∏π
      </a>
</div>
</div>
<script>
     document.getElementById('registerDropdownBtn').addEventListener('click', function(event) {
  event.stopPropagation();
  document.getElementById('dropdownMenu').classList.toggle('hidden');
});
document.addEventListener('click', function(event) {
  const dropdown = document.getElementById('dropdownMenu');
  if (!dropdown.contains(event.target)) dropdown.classList.add('hidden');
});
function openModal(id) {
  document.getElementById(id).classList.remove('hidden');
}
function closeModal(id) {
  document.getElementById(id).classList.add('hidden');
}
    </script>
<!-- Student Modal -->
<script>
     function checkFileSize(input) {
  if (input.files[0].size > 1024 * 1024) {
    alert("‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1MB");
    input.value = "";
  }
}

      const form = e.target;
    const formData = new FormData(form);
    const jsonData = {};

    formData.forEach((value, key) => {
      jsonData[key] = value;
    });

    fetch("https://script.google.com/macros/s/AKfycbxdY__BNd_oV2kTNa4rT7lS0YaHJHwRPGCHCR9PmcPBfKnTXZfLWXbx1Nf1FslsRuUH/exec", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(jsonData)
    })
    .then(response => response.text())
    .then(result => {
      document.getElementById("studentStatus").innerHTML = "‚úÖ " + result;
      form.reset();
    })
    .catch(error => {
      console.error("Error!", error.message);
      document.getElementById("studentStatus").innerHTML = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î";
    });
  });
    </script>
<!-- Teacher Modal -->
</div>
<span class="text-white text-sm hidden sm:inline-block" id="userDisplay">
    üëã ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö
   </span>
</header>

<!-- üîî Top Alert (login required) -->
<div id="topAlert" class="w-full bg-yellow-100 text-red-600 text-sm md:text-base px-4 py-2 text-center font-mitr">
‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô/‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö ‚Äî ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏î‡πâ
</div>

<!-- Main Section -->
<main class="max-w-6xl mx-auto bg-white bg-opacity-90 mt-10 p-6 rounded-xl shadow-lg">
<div class="flex flex-col items-center justify-center text-center py-10">
<img alt="iCARE+ logo" class="mx-auto my-4 h-20 sm:h-24 md:h-28 lg:h-32" src="https://img2.pic.in.th/pic/loICARE08d2635f15818a2a.png"/>
<h2 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold text-purple-800 mb-4 font-exo2">
     Latbualuang iCARE+
    </h2>
<h3 class="text-lg sm:text-xl text-blue-600 mb-2 font-mitr">
     ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏™‡πà‡πÉ‡∏à ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå
    </h3>
<p class="text-sm text-purple-600 mb-2 font-mitr">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏¢ ‡∏£‡∏≠‡∏á‡∏Ø ‡∏†‡∏±‡∏ó‡∏£‡∏°‡∏ì‡∏ë‡∏ô‡πå ‡∏õ‡∏≤‡∏ô‡∏°‡∏≠‡∏ç</p>
</div>
<!-- Info Section -->
<div class="flex flex-col lg:flex-row items-center justify-between mt-10 space-y-6 lg:space-y-0 lg:space-x-10">
<img alt="‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö" class="w-full max-w-md rounded-lg shadow-md" src="https://img5.pic.in.th/file/secure-sv1/L.P.W.-v.33ec1544647496647.png"/>
<div class="text-center lg:text-left">
<h2 class="text-xl sm:text-2xl md:text-3xl font-bold text-blue-700 mb-1 font-mitr">
      Latbualuang iCARE+
     </h2>
<h3 class="text-sm sm:text-base md:text-lg text-pink-500 mb-4 font-mitr">
      ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå
     </h3>
<p class="text-base text-gray-700 mb-6">
      ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏Ñ‡∏£‡∏π ‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡∏≤‡∏î‡∏ö‡∏±‡∏ß‡∏´‡∏•‡∏ß‡∏á‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏¢ ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ AI ‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡∏ú‡∏™‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏≠‡∏≤‡πÉ‡∏à‡πÉ‡∏™‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô
     </p>
<div class="space-y-3">
<button class="w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg text-lg font-mitr" onclick="openModal('emergencyModal')">
       üö®üÜò ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ôüö®
      </button>
<button class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg text-lg font-mitr" onclick="document.getElementById('icareListenModal').classList.remove('hidden')">
       üìû iCARE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠
      </button><hr>
<a href="emo.html"><button class="w-full bg-blue-400 hover:bg-blue-500 text-white py-2 rounded-lg text-lg font-mitr">üòä ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å</button></a>
</div>
</div>
</div>
<!-- Quote -->
<div class="text-center mt-10">
<p class="text-md text-purple-600 italic">
<span class="font-mitr">
      "‡πÄ‡∏°‡∏∑‡πà‡∏≠ AI ‡∏à‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß ‡∏Ñ‡∏£‡∏π‡∏à‡∏∂‡∏á‡∏Å‡∏≠‡∏î‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÅ‡∏Ñ‡πà
      <strong>
       '‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô'
      </strong>
      ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏≠... ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á
      <strong>
       '‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á'
      </strong>
      ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°"
     </span>
</p>
</div>
</main>
<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>
     ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ - Latbualuang iCARE+
    </title>
<script src="https://cdn.tailwindcss.com">
</script>
<link href="https://fonts.googleapis.com/css2?family=Mitr&amp;display=swap" rel="stylesheet"/>
<style>
     .font-mitr { font-family: "Mitr", sans-serif; }
    </style>
<link href="https://fonts.googleapis.com/css2?family=Exo+2&amp;display=swap" rel="stylesheet"/>
<style>
     .font-exo2 { font-family: "Exo 2", sans-serif; }
    </style>
<link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/flatpickr">
</script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/th.js">
</script>
</head>
<body class="bg-gray-50 text-gray-800">
<!-- Section: Our Services -->
<section class="bg-white py-12 px-4 font-mitr">
<div class="max-w-7xl mx-auto">
<h2 class="text-2xl sm:text-3xl font-bold text-center text-purple-700 mb-10 text-lg sm:text-xl md:text-2xl">
       ‚ú® ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‚ú®
      </h2>
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
<!-- Risk & Alert Map -->
<div class="bg-white rounded-xl shadow-md p-6 border border-red-100 text-center">
<div class="text-4xl mb-2">
         üìç
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á
        </h3>
<p class="text-sm text-gray-600 mb-4">
         Ladbualuang iCARE+ Risk &amp; Alert Map
        </p>
<a class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full text-sm font-mitr" href="#" onclick="document.getElementById('riskMapModal').style.display='flex'">
         ‡∏î‡∏π‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
        </a>
</div>
<!-- Join iCARE+ -->
<div class="bg-white rounded-xl shadow-md p-6 border border-blue-100 text-center">
<div class="text-4xl mb-2">
         üì≤
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° iCARE+
        </h3>
<p class="text-sm text-gray-600 mb-4">
         ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        </p>
<a class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-mitr" href="#">
         ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
        </a>
</div>
<!-- CARE Watch -->
<div class="bg-white rounded-xl shadow-md p-6 border border-green-100 text-center">
<div class="text-4xl mb-2">
         üë•
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ CARE Watch ‡∏£‡∏∏‡πà‡∏ô‡∏à‡∏¥‡πã‡∏ß
        </h3>
<p class="text-sm text-gray-600 mb-4">
         ‡∏ó‡∏µ‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏ó‡πâ ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡πÇ‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à
        </p>
<a class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full text-sm font-mitr" href="#">
         ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°
        </a>
</div>
<!-- iCARE Stories -->
<div class="bg-white rounded-xl shadow-md p-6 border border-purple-100 text-center">
<div class="text-4xl mb-2">
         üé•üíô
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         iCARE Stories ü§ñ‚ù§Ô∏è
        </h3>
<p class="text-sm text-gray-600 mb-4">
         ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏î‡πâ‡∏ß‡∏¢‡πÉ‡∏à
        </p>
<a class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-full text-sm font-mitr" href="#">
         ‡∏î‡∏π‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß
        </a>
</div>
<!-- Partnership -->
<div class="bg-white rounded-xl shadow-md p-6 border border-yellow-100 text-center">
<div class="text-4xl mb-2">
         üîç
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠
        </h3>
<p class="text-sm text-gray-600 mb-4">
         ‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
        </p>
<a class="bg-yellow-400 hover:bg-yellow-500 text-white px-4 py-2 rounded-full text-sm font-mitr" href="#">
         ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
        </a>
</div>
<!-- Safety & Ethics -->
<div class="bg-white rounded-xl shadow-md p-6 border border-blue-200 text-center">
<div class="text-4xl mb-2">
         üîê
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°
        </h3>
<p class="text-sm text-gray-600 mb-4">
         ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
        </p>
<a onclick="openPolicyModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full text-sm font-mitr" href="#">
         ‡∏≠‡πà‡∏≤‡∏ô‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢
        </a>
</div>
<!-- Documents -->
<div class="bg-white rounded-xl shadow-md p-6 border border-pink-100 text-center">
<div class="text-4xl mb-2">
         üßæ
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
        </h3>
<p class="text-sm text-gray-600 mb-4">
         ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
        </p>
<a class="bg-pink-500 hover:bg-pink-600 text-white px-4 py-2 rounded-full text-sm font-mitr" href="#">
         ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
        </a>
</div>
<!-- Admin Back Office -->
<div class="bg-white rounded-xl shadow-md p-6 border border-gray-200 text-center">
<div class="text-4xl mb-2">
         üóÇÔ∏è
        </div>
<h3 class="text-lg font-semibold mb-1 text-base sm:text-lg md:text-xl">
         ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô
        </h3>
<p class="text-sm text-gray-600 mb-4">
         Back-office Dashboard ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö
        </p>
<a class="bg-gray-800 hover:bg-black text-white px-4 py-2 rounded-full text-sm font-mitr" href="file:///C:/Users/User/OneDrive/%E0%B8%A5.%E0%B8%9E.%E0%B8%A7.%202568/%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%94%E0%B9%87%E0%B8%99%E0%B8%97%E0%B9%89%E0%B8%B2%E0%B8%97%E0%B8%B2%E0%B8%A2%20%E0%B9%81%E0%B8%81%E0%B9%89%E0%B9%84%E0%B8%82%E0%B9%80%E0%B8%A3%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88/web%20app/Latbualuang_iCARE+/iCARE_Hub_Dashboard.html">
         ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
        </a>
</div>
</div>
</div>
</section>
<script>
     function togglePassword(id) {
  const input = document.getElementById(id);
  input.type = input.type === "password" ? "text" : "password";
}
    </script>
<!-- üö® Emergency Report Modal (Step 1: UI only) -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden p-4" id="emergencyModal">
<div class="bg-red-100 rounded-2xl shadow-2xl w-full max-w-md relative overflow-y-auto max-h-screen p-6 font-mitr">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="closeModal('emergencyModal')">
       ‚úñ
      </button>
<h2 class="text-xl sm:text-2xl font-bold text-red-600 mb-4 text-center">
       üö®üÜò ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ôüö®
      </h2>
<p class="text-sm text-blue-700 mt-2 mb-2 font-mitr" id="reporterName">
 üë§ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏î‡∏¢: (‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á...)
</p>
<input id="ReportedBy" name="ReportedBy" type="hidden"/>
<form action="https://script.google.com/macros/s/AKfycbxLWBNIqSfa_88ONWAlsK-gNBLQZBVTOT4za3xWFANrZ-_6ZQgmtLD4VB4NlXo2Y6ZD/exec" class="space-y-3" enctype="multipart/form-data" id="emergencyForm" method="POST">
<!-- Displayed student info (to be filled in dynamically after login) -->
<!-- Emergency Type Dropdown -->
<div>
<label class="block text-sm">
         ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô:
        </label>
<select class="w-full px-3 py-2 rounded border text-black bg-white" id="emergencyType" name="EmergencyType" onchange="this.style.color='#000';" style="color:#60A5FA;">
<option disabled="" selected="" value="">
          -- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏ --
         </option>
<optgroup label="üî¥ ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢" style="background-color:#fecaca;">
<option style="background-color:#fee2e2;">
           üí• ‡∏û‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
          </option>
<option style="background-color:#fee2e2;">
           üëä ‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏ß‡∏¥‡∏ß‡∏≤‡∏ó / ‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Å‡∏±‡∏ô
          </option>
<option style="background-color:#fee2e2;">
           üò¢ ‡∏ñ‡∏π‡∏Å‡∏£‡∏±‡∏á‡πÅ‡∏Å / ‡∏ö‡∏π‡∏•‡∏•‡∏µ‡πà (Bullying)
          </option>
<option style="background-color:#fee2e2;">
           üö¨ ‡∏û‡∏ö‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î / ‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå / ‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà
          </option>
<option style="background-color:#fee2e2;">
           üìµ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÅ‡∏Å‡∏•‡πâ‡∏á‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
          </option>
</optgroup>
<optgroup label="üü† ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô" style="background-color:#fed7aa;">
<option style="background-color:#ffedd5;">
           ü§¢ ‡∏õ‡πà‡∏ß‡∏¢‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô / ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏° / ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ / ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å
          </option>
<option style="background-color:#ffedd5;">
           üß† ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á / ‡∏ß‡∏¥‡∏ï‡∏Å‡∏Å‡∏±‡∏á‡∏ß‡∏• / ‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå
          </option>
<option style="background-color:#ffedd5;">
           ü©π ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏ / ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° / ‡∏•‡∏∑‡πà‡∏ô‡∏•‡πâ‡∏°
          </option>
</optgroup>
<optgroup label="üü° ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà" style="background-color:#fef08a;">
<option style="background-color:#fef9c3;">
           üî• ‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ / ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÑ‡∏´‡∏°‡πâ / ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏•‡∏±‡∏î‡∏ß‡∏á‡∏à‡∏£
          </option>
<option style="background-color:#fef9c3;">
           ‚ö†Ô∏è ‡∏û‡∏ö‡∏Ñ‡∏ô‡πÅ‡∏õ‡∏•‡∏Å‡∏´‡∏ô‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏ö‡∏∏‡∏Å‡∏£‡∏∏‡∏Å‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
          </option>
<option style="background-color:#fef9c3;">
           üßØ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå / ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πà‡∏ô‡∏ä‡∏≥‡∏£‡∏∏‡∏î
          </option>
<option style="background-color:#fef9c3;">
           üö∂‚Äç‚ôÇÔ∏è ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏≤‡∏¢‡∏ï‡∏±‡∏ß / ‡πÄ‡∏î‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
          </option>
</optgroup>
<optgroup label="üü¢ ‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" style="background-color:#bbf7d0;">
<option style="background-color:#dcfce7;" value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)">
           üí¨ ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)
          </option>
</optgroup>
</select>
<input class="mt-2 w-full px-3 py-2 rounded border text-black hidden" id="otherEmergencyInput" name="OtherEmergencyDetail" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." type="text"/>
</div>
<!-- Location -->
<div>
<label class="block text-sm">
         ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏:
        </label>
<input class="w-full px-3 py-2 rounded border text-black" name="Location" required="" type="text"/>
</div>
<!-- File Uploads -->
<div>
<label class="block text-sm text-black">
       ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="imageFile" accept="image/*"/>
<label class="block text-sm mt-2 text-black" style="color:#000 !important;">
       ‡πÅ‡∏ô‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡πÄ‡∏™‡∏µ‡∏¢‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="audioFile" accept="audio/*"/>
<label class="block text-sm mt-2 text-black" style="color:#000 !important;">
       ‡πÅ‡∏ô‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="videoFile" accept="video/*"/>
<p class="text-xs text-gray-600 mt-1">
       ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏ß‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB
      </p>
</div>
<!-- Confirmation -->
<label class="inline-flex items-start text-sm text-gray-700">
<input class="mr-2 mt-1" required="" type="checkbox"/ name="Confirm">
        ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ß‡πà‡∏≤ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£
       </label>
<p class="text-xs text-red-500 italic">
        üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô
       </p>
<!-- Submit -->
<div class="text-center pt-2">
<button class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded" type="submit">
         ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏
        </button>
<p class="text-sm mt-2" id="emergencyStatus">
</p>
</div>
</form>
</div>
</div>
<script>
     function toggleOtherInput(value) {
  const input = document.getElementById("otherEmergencyInput");
  input.classList.toggle("hidden", value !== "‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)");
}
    </script>
<!-- ‚úÖ New Login Modal -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" id="loginModal">
<div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-sm relative font-mitr">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="document.getElementById('loginModal').classList.add('hidden')">
       ‚úñ
      </button>
<h2 class="text-xl font-bold mb-4 text-yellow-600">
       üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
      </h2>
<form class="space-y-3" id="loginForm">
<input class="w-full px-3 py-2 rounded border" name="Username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required="" type="text"/>
<input class="w-full px-3 py-2 rounded border" name="Password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required="" type="password"/>
<button class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded" type="submit">
        ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
       </button>
<p class="text-center text-sm mt-2 text-red-600" id="loginStatus">
</p>
</form>
</div>
</div>
<!-- ‚úÖ Login Script -->
<script>
     const loginScriptURL = "https://script.google.com/macros/s/AKfycbw7X3QPSj76DJR9eelvRI73MGZIltO_WX1g2OdQ5RIAhfxs_6ecBwJZa6V_qImLctIHuA/exec";

  document.getElementById("loginForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const username = this.Username.value.trim();
    const password = this.Password.value.trim();
    const formData = new FormData();
    formData.append("Username", username);
    formData.append("username", username);
    formData.append("Password", password);
    formData.append("password", password);
    formData.append("IP_Address", "Auto");
    formData.append("ip", "Auto");
    formData.append("Device", navigator.userAgent);
    formData.append("device", navigator.userAgent);

    fetch(loginScriptURL, {
      method: "POST",
      body: formData,
    })
    .then((res) => res.json())
    .then((data) => {
      const ok = data && (data.success === true || data.status === 'success');
      if (ok) {
        sessionStorage.setItem("userData", JSON.stringify(data));
        document.getElementById("loginStatus").textContent = "‚úÖ üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        document.getElementById("loginModal").classList.add("hidden");
        enableProtectedFeatures(); if(window.onLoginSuccess){ try{ window.onLoginSuccess(); }catch(_){} }
alert(`‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${data.Prefix}${data.FirstName} ${data.LastName}`);
      } else {
        document.getElementById("loginStatus").textContent = "‚ùå " + data.message;
      }
    })
    .catch((err) => {
      document.getElementById("loginStatus").textContent = "‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message;
    });
  });

  function enableProtectedFeatures() {
    const protectedButtons = document.querySelectorAll(".protected-button, .protected-form");
    protectedButtons.forEach(btn => {
      btn.disabled = false;
      btn.classList.remove("opacity-50", "pointer-events-none");
    });
  }

  window.onload = function () {
    const user = sessionStorage.getItem("userData");
    if (!user) {
      const protectedButtons = document.querySelectorAll(".protected-button, .protected-form");
      protectedButtons.forEach(btn => {
        btn.disabled = true;
        btn.classList.add("opacity-50", "pointer-events-none");
      });
    } else {
      enableProtectedFeatures(); if(window.onLoginSuccess){ try{ window.onLoginSuccess(); }catch(_){} }
}
  };
    </script>
<script>
     document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll("select option").forEach(opt => {
    const text = opt.textContent.trim();
    if (["‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢", "‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á", "‡∏ô‡∏≤‡∏¢", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", "-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --"].includes(text)) {
      opt.style.color = "#60A5FA";
    }
  });
});
    </script>
<script>
     document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll("select option").forEach(opt => {
    const text = opt.textContent.trim();
    if (text) {
      opt.style.color = "#60A5FA";
    }
  });
});
    </script>
<script>
     document.addEventListener("DOMContentLoaded", function () {
  const placeholders = ["‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤", "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô", "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];
  document.querySelectorAll("input[placeholder], select[placeholder]").forEach(el => {
    if (placeholders.includes(el.placeholder.trim())) {
      el.style.color = "#60A5FA";
    }
  });
});
    </script>
<script>
     document.addEventListener("DOMContentLoaded", function () {
  const targets = ["-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --", "-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --", "-- ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];

  // Set color for placeholder-like options in select dropdowns
  document.querySelectorAll("select option").forEach(option => {
    if (targets.includes(option.textContent.trim())) {
      option.style.color = "#60A5FA";
    }
  });

  // Set color for placeholder in input fields
  document.querySelectorAll("input[placeholder]").forEach(input => {
    if (targets.includes(input.placeholder.trim())) {
      input.style.color = "#60A5FA";
    }
  });
});
    </script>
<script>
     document.addEventListener("DOMContentLoaded", function () {
  const blueOptions = ["-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --", "-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --", "-- ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];
  document.querySelectorAll("select option").forEach(opt => {
    if (blueOptions.includes(opt.textContent.trim())) {
      opt.style.color = "#60A5FA";
    }
  });
});
    </script>
<script>
     flatpickr("#birthdate", {
    dateFormat: "d/m/Y",
    locale: "th",
    allowInput: true
  });
    </script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const photoInput = document.getElementById("TeacherPhoto");
  const statusDiv = document.getElementById("teacherFormMessage");

  if (photoInput) {
    photoInput.addEventListener("change", function () {
      const file = this.files[0];
      if (file && file.size > 1024 * 1024) {
        statusDiv.textContent = "‚ùå ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1MB";
        statusDiv.className = "text-red-600";
        this.value = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤
      } else {
        statusDiv.textContent = "";
        statusDiv.className = "";
      }
    });
  }
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const user = JSON.parse(sessionStorage.getItem("userData") || "{}");

  const fullName = `${user.Prefix || ""}${user.FirstName || ""} ${user.LastName || ""}`.trim();
  const classroom = user.Class && user.Room ? ` ‡∏°.${user.Class}/${user.Room}` : "";
  const displayName = fullName + classroom;

  // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô UI
  const display = document.getElementById("reporterName");
  if (display) {
    display.textContent = "üë§ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏î‡∏¢: " + displayName;
  }

  // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤ hidden input ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÉ‡∏ô Google Sheet
  const input = document.getElementById("ReportedBy");
  if (input) {
    input.value = displayName;
  }
});
</script>

<!-- üìû iCARE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠ Modal -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden p-4" id="icareListenModal">
<div class="bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto p-6 font-mitr relative">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="document.getElementById('icareListenModal').classList.add('hidden')">‚úñ</button>
<h2 class="text-2xl font-bold text-center mb-4 text-green-600">üìû iCARE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠</h2>
<form class="space-y-4" id="icareListenForm">
<div>
<label class="block text-sm font-mitr" for="icareReason" style="color:#60D9A3;">‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</label>
<select class="w-full px-3 py-2 rounded border text-black bg-white font-mitr" id="icareReason" name="icareReason" onchange="this.style.color='#000';" required="" style="color:#60D9A3;">
<option disabled="" selected="" value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• --</option>
<option>üòä ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏Ñ‡∏£‡∏™‡∏±‡∏Å‡∏Ñ‡∏ô‡∏ü‡∏±‡∏á (‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ ‡πÅ‡∏Ñ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πá‡∏û‡∏≠‡πÅ‡∏•‡πâ‡∏ß)</option>
<option>üë©‚Äçüè´ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</option>
<option>üìû ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö (‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ)</option>
<option>ü§ù ‡∏≠‡∏¢‡∏≤‡∏Å‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á (‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡∏≤‡∏ö‡πâ‡∏≤‡∏á ‡∏Å‡πá‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ô‡∏≠‡∏∞)</option>
<option>üë®‚Äçüíº ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏• (‡∏ö‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠)</option>
<option>‚úçÔ∏è ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)</option>
</select>
</div>
<div>
<label class="block text-sm text-gray-700 font-mitr" for="icareDetails">‚úçÔ∏è ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
<textarea class="w-full px-3 py-2 rounded border text-black font-mitr min-h-[150px]" id="icareDetails" name="icareDetails" placeholder="" rows="6" style="resize: none;" required=""></textarea>
</div>
<p class="text-sm text-gray-600 mt-2 font-mitr">üîê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
<p class="text-sm text-green-600 italic font-mitr">üôè ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏à üíõ ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏û‡∏±‡∏á ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏™‡∏°‡∏≠</p>
<div class="text-center">
<button class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded font-mitr" style="width: auto;" type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
<p class="text-sm mt-2 font-mitr" id="icareListenStatus"></p>
</div>
</form>
</div>
</div>
<script>
  
document.getElementById("icareListenForm")?.addEventListener("submit", async function (e) {
  e.preventDefault();
  e.stopImmediatePropagation();
  const status = document.getElementById("icareListenStatus");
  status.textContent = "";
  status.className = "text-sm font-mitr mt-2";

  // prevent double submit
  if (this.dataset.submitting === "1") { return; }
  this.dataset.submitting = "1";
  const submitBtn = this.querySelector('[type="submit"]');
  if (submitBtn) submitBtn.disabled = True;

  try {
    // validate required fields
    const reasonEl = document.getElementById("icareReason");
    const detailsEl = document.getElementById("icareDetails");
    const reason = (reasonEl?.value || "").trim();
    const details = (detailsEl?.value || "").trim();
    if (!reason) {
      status.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£";
      status.classList.add("text-red-600");
      return;
    }
    if (!details) {
      status.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°";
      status.classList.add("text-red-600");
      return;
    }

    // must be logged in
    let session = null;
    try { session = JSON.parse(sessionStorage.getItem("userData") || "null"); } catch(_) {}
    if (!session) {
      status.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
      status.classList.add("text-red-600");
      return;
    }
    const usr = session && session.data ? session.data : session;
    const username = usr && (usr.Username || usr.username);
    if (!username) {
      status.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà";
      status.classList.add("text-red-600");
      return;
    }

    // build payload
    const fd = new FormData();
    fd.append("Action", "ListenSubmit");
    fd.append("Source", "ListenForm");
    fd.append("IP_Address", "Auto");
    fd.append("Device", navigator.userAgent);
    fd.append("Username", username);
    // try include student context if available
    const ctx = {
      StudentID: usr.StudentID,
      Prefix_Student: usr.Prefix_Student || usr.Prefix,
      FirstName_Student: usr.FirstName_Student || usr.FirstName,
      LastName_Student: usr.LastName_Student || usr.LastName,
      Class: usr.Class, Room: usr.Room, StudentPhone: usr.StudentPhone || usr.Phone
    };
    Object.keys(ctx).forEach(k => { if (ctx[k]) fd.append(k, String(ctx[k])); });

    fd.append("ListenReason", reason);
    fd.append("ListenDetails", details);

    // endpoint
    const listenURL = "https://script.google.com/macros/s/AKfycbzejn_sGgjDfOYU5nNtOV8hsgESSL0Pc7747Da5kGjwJXhiGzkse13WBliJY9iSy8GV/exec";

    const res = await fetch(listenURL, { method: "POST", body: fd });
    const text = await res.text().catch(()=>"");
    if (res.ok) {
      status.textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
      status.classList.add("text-green-600");
      this.reset();
      if (reasonEl) reasonEl.value = "";
    } else {
      status.textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (text || res.status);
      status.classList.add("text-red-600");
    }
  } catch (err) {
    // last attempt in no-cors (best-effort fire-and-forget)
    try {
      const listenURL = "https://script.google.com/macros/s/AKfycbzejn_sGgjDfOYU5nNtOV8hsgESSL0Pc7747Da5kGjwJXhiGzkse13WBliJY9iSy8GV/exec";
      const fd2 = new FormData(this);
      // ensure our fields are included again
      const reasonVal = (document.getElementById("icareReason")?.value || "").trim();
      const detailsVal = (document.getElementById("icareDetails")?.value || "").trim();
      fd2.set("ListenReason", reasonVal);
      fd2.set("ListenDetails", detailsVal);
      await fetch(listenURL, { method: "POST", body: fd2, mode: "no-cors" });
      status.textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
      status.classList.add("text-green-600");
      this.reset();
    } catch (err2) {
      status.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: " + (err?.message || err);
      status.classList.add("text-red-600");
    }
  } finally {
    this.dataset.submitting = "0";
    const submitBtn2 = this.querySelector('[type="submit"]');
    if (submitBtn2) submitBtn2.disabled = false;
  }
});
if (_totalBytes > 5 * 1024 * 1024) { statusEl.textContent="‚ùå ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 5MB"; statusEl.classList.add("text-red-600"); return; }

    let session = null; try { session = JSON.parse(sessionStorage.getItem("userData") || "null"); } catch(_){}
    if (!session) { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏"; statusEl.classList.add("text-red-600"); return; }
    const usr = session && session.data ? session.data : session;
    const username = usr && (usr.Username || usr.username);
    if (!username) { statusEl.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà"; statusEl.classList.add("text-red-600"); return; }

    const fd = new FormData(form);
// --- Force fields for GAS ---
fd.set("EmergencyType", typeVal);
fd.set("Location", locVal);
if (confirmBox && confirmBox.checked) fd.set("Confirm","1");
// Map 'OtherEmergencyDetail' -> 'EmergencyOther'
if (typeof otherInput !== "undefined" && otherInput) {
  const otherVal = String(otherInput.value||"").trim();
  if (otherVal) fd.set("EmergencyOther", otherVal);
}
    fd.append("Username", username);

    let ctx = {
      StudentID: usr.StudentID,
      Prefix_Student: usr.Prefix_Student || usr.Prefix,
      FirstName_Student: usr.FirstName_Student || usr.FirstName,
      LastName_Student: usr.LastName_Student || usr.LastName,
      Class: usr.Class, Room: usr.Room, StudentPhone: usr.StudentPhone || usr.Phone
    };
    if (!ctx.StudentID || !ctx.FirstName_Student || !ctx.LastName_Student) {
      const looked = await lookupStudentContext(username);
      if (looked) {
        ctx.StudentID = ctx.StudentID || looked.StudentID || looked.studentId || "";
        ctx.Prefix_Student = ctx.Prefix_Student || looked.Prefix_Student || looked.Prefix || "";
        ctx.FirstName_Student = ctx.FirstName_Student || looked.FirstName_Student || looked.FirstName || "";
        ctx.LastName_Student  = ctx.LastName_Student  || looked.LastName_Student  || looked.LastName  || "";
        ctx.Class = ctx.Class || looked.Class || "";
        ctx.Room  = ctx.Room  || looked.Room  || "";
        ctx.StudentPhone = ctx.StudentPhone || looked.StudentPhone || looked.Phone || "";
      }
    }
    Object.keys(ctx).forEach(k => { if (ctx[k]) fd.append(k, String(ctx[k])); });

    fd.append("IP_Address","Auto"); fd.append("Device", navigator.userAgent); fd.append("Source","EmergencyForm");

    const url = form.action || "https://script.google.com/macros/s/AKfycbxLWBNIqSfa_88ONWAlsK-gNBLQZBVTOT4za3xWFANrZ-_6ZQgmtLD4VB4NlXo2Y6ZD/exec";
    try {
      const res = await fetch(url, { method:"POST", body: fd });
      const txt = await res.text().catch(()=> "");
      if (res.ok) {
        statusEl.textContent = "‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"; statusEl.classList.add("text-green-600");
        if (typeSel) typeSel.value=""; if (locInput) locInput.value=""; if (otherInput) { otherInput.value=""; otherInput.classList.add("hidden"); } if (confirmBox) confirmBox.checked=false;
      } else {
        statusEl.textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (txt || res.status); statusEl.classList.add("text-red-600");
      }
    } catch (err) {
      try {
        await fetch(url, { method:"POST", body: fd, mode:"no-cors" });
        statusEl.textContent = "‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        statusEl.classList.add("text-green-600");
        if (typeSel) typeSel.value="";
        if (locInput) locInput.value="";
        if (otherInput) { otherInput.value=""; otherInput.classList.add("hidden"); }
        if (confirmBox) confirmBox.checked=false;
      } catch (e2) {
        statusEl.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: " + err.message;
        statusEl.classList.add("text-red-600");
      }
    }
  });
})();
</script>

<script>window.loginScriptURL="https://script.google.com/macros/s/AKfycbytXOkLNA8p-uIJI53L0xGzkOu8f76VSf5pj5kdCH5y7llpgEIQ8zm9rqHoNaxyzi937A/exec";</script>

<!-- Block file inputs for emergency form (show "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö") -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const inputs = Array.from(document.querySelectorAll(
    '#emergencyForm input[type="file"][name="imageFile"],' +
    '#emergencyForm input[type="file"][name="audioFile"],' +
    '#emergencyForm input[type="file"][name="videoFile"]'
  ));
  function block(e) {
    e.preventDefault();
    e.stopImmediatePropagation();
    alert("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö");
    return false;
  }
  inputs.forEach((inp) => {
    // Prevent opening file dialog by intercepting multiple events
    ["click","mousedown","focus","keydown","change","dragover","drop"].forEach(evt => {
      inp.addEventListener(evt, block, true);
    });
    // Visual cue
    inp.style.cursor = "not-allowed";
    inp.title = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö";
    // Ensure value is cleared in case browser still sets it
    inp.value = "";
  });
});
</script>

<script>

(function(){
  const form = document.getElementById("icareListenForm");
  if (!form) return;

  // Add hidden iframe fallback target
  let iframe = document.getElementById("listenHiddenFrame");
  if (!iframe) {
    iframe = document.createElement("iframe");
    iframe.style.display = "none";
    iframe.id = "listenHiddenFrame";
    document.body.appendChild(iframe);
  }

  const statusEl = document.getElementById("icareListenStatus");
  const setStatus = (msg, ok)=>{
    if (!statusEl) return;
    statusEl.textContent = msg || "";
    statusEl.classList.remove("text-red-600","text-green-600");
    statusEl.classList.add(ok ? "text-green-600":"text-red-600");
  };

  function getValByPref(ids, names){
    for (const id of (ids||[])) {
      const el = document.getElementById(id);
      if (el && typeof el.value !== "undefined") return String(el.value||"").trim();
    }
    for (const nm of (names||[])) {
      const el = form.querySelector(`[name="${nm}"]`);
      if (el && typeof el.value !== "undefined") return String(el.value||"").trim();
    }
    return "";
  }

  form.addEventListener("submit", async function(e){
    e.preventDefault();
    e.stopImmediatePropagation();
    setStatus("", true);

    if (form.dataset.submitting === "1") return;
    form.dataset.submitting = "1";
    const submitBtn = form.querySelector('[type="submit"]');
    if (submitBtn) submitBtn.disabled = true;

    try {
      // Validate required fields in the form generically
      const requiredEls = form.querySelectorAll("[required]");
      for (const el of requiredEls) {
        if (!el.value || String(el.value).trim() === "") {
          setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á", false);
          if (submitBtn) submitBtn.disabled = false;
          form.dataset.submitting = "0";
          return;
        }
      }

      // Session / login data
      let sess = null;
      try { sess = JSON.parse(sessionStorage.getItem("userData") || "null"); } catch(_){}
      if (!sess) { try { sess = JSON.parse(localStorage.getItem("userData") || "null"); } catch(_){ } }
      if (!sess) { try { sess = JSON.parse(localStorage.getItem("studentData") || "null"); } catch(_){ } }

      const user = (sess && sess.data) ? sess.data : sess;
      const username = user && (user.Username || user.username);
      if (!username) {
        setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", false);
        if (submitBtn) submitBtn.disabled = false;
        form.dataset.submitting = "0";
        return;
      }

      // Gather values (support multiple DOM names/ids)
      const reason  = getValByPref(["icareReason"], ["ListenReason","reason"]);
      const details = getValByPref(["icareDetails"],["ListenDetails","details"]);
      if (!reason)  { setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£", false);  submitBtn && (submitBtn.disabled=false); form.dataset.submitting="0"; return; }
      if (!details) { setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°", false); submitBtn && (submitBtn.disabled=false); form.dataset.submitting="0"; return; }

      // Build payload
      const fd = new FormData();
      const rid = (crypto.randomUUID ? crypto.randomUUID() : Date.now().toString(36)+Math.random().toString(36).slice(2));
      fd.append("RequestID", rid);
      fd.append("Username", username);
      fd.append("ListenReason", reason);
      fd.append("ListenDetails", details);
      fd.append("Source", "ListenForm");
      fd.append("IP_Address", "Auto");
      fd.append("Device", navigator.userAgent);

      // pass student context if present
      const ctx = {
        StudentID: user && user.StudentID,
        Prefix_Student: (user && (user.Prefix_Student || user.Prefix)),
        FirstName_Student: (user && (user.FirstName_Student || user.FirstName)),
        LastName_Student:  (user && (user.LastName_Student  || user.LastName)),
        Class: user && user.Class,
        Room:  user && user.Room,
        StudentPhone: user && (user.StudentPhone || user.Phone)
      };
      Object.keys(ctx).forEach(k => { if (ctx[k]) fd.append(k, String(ctx[k])); });

      const ENDPOINT = "https://script.google.com/macros/s/AKfycbzejn_sGgjDfOYU5nNtOV8hsgESSL0Pc7747Da5kGjwJXhiGzkse13WBliJY9iSy8GV/exec";

      // Try normal fetch first
      let ok = false, txt = "";
      try {
        const resp = await fetch(ENDPOINT, { method: "POST", body: fd });
        txt = await resp.text().catch(()=> "");
        ok = resp.ok || (txt && /‚úÖ/.test(txt));
      } catch (err) {
        // ignore, will fallback
      }

      if (!ok) {
        // Hidden iframe fallback (classic HTML POST) to beat CORS/network oddities
        const tempForm = document.createElement("form");
        tempForm.action = ENDPOINT;
        tempForm.method = "POST";
        tempForm.enctype = "multipart/form-data";
        tempForm.target = "listenHiddenFrame";
        tempForm.style.display = "none";

        const add = (k,v)=>{
          const inp = document.createElement("input");
          inp.type = "hidden"; inp.name = k; inp.value = v;
          tempForm.appendChild(inp);
        };
        add("RequestID", rid);
        add("Username", username);
        add("ListenReason", reason);
        add("ListenDetails", details);
        add("Source", "ListenForm");
        add("IP_Address", "Auto");
        add("Device", navigator.userAgent);
        Object.keys(ctx).forEach(k => { if (ctx[k]) add(k, String(ctx[k])); });

        document.body.appendChild(tempForm);
        tempForm.submit();
        setTimeout(()=> { document.body.removeChild(tempForm); }, 2000);
        ok = true; // will rely on GAS idempotency
      }

      if (ok) {
        setStatus("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", true);
        form.reset();
      } else {
        setStatus("‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à " + (txt ? (": " + txt) : ""), false);
      }

    } catch (err) {
      setStatus("‚ùå ‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á: " + (err && err.message ? err.message : err), false);
    } finally {
      form.dataset.submitting = "0";
      const submitBtn2 = form.querySelector('[type="submit"]');
      if (submitBtn2) submitBtn2.disabled = false;
    }
  });
})();

</script>

<!-- üîê Floating Login Button -->
<button id="floatingLoginBtn" title="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö" onclick="document.getElementById('loginModal')?.classList.remove('hidden')"
style="position:fixed; right:16px; bottom:16px; z-index:9999; background:#1d4ed8; color:#fff; border:none; border-radius:9999px; padding:12px 16px; box-shadow:0 10px 20px rgba(0,0,0,.15); font-family:'Mitr',sans-serif;">
üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
</button>


<!-- üîê Safety & Ethics Policy Modal -->
<div id="policyModal" class="fixed inset-0 z-[9998] hidden items-center justify-center bg-black bg-opacity-40 p-4">
  <div class="relative w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl p-6 font-mitr"
       style="background: linear-gradient(135deg,#e0f2fe, #fde7f3, #fff7d6);
              border: 2px solid transparent;
              border-image: linear-gradient(135deg,#60a5fa,#f59e0b,#ec4899) 1;
              box-shadow: 0 20px 40px rgba(0,0,0,.2);">
    <button aria-label="close" onclick="document.getElementById('policyModal').classList.add('hidden')"
            class="absolute top-3 right-3 text-gray-700 hover:text-black text-xl">‚ùå</button>

    <h2 class="text-center text-blue-700 text-2xl md:text-3xl font-bold mb-2">üîê ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°</h2>
    <p class="text-center text-blue-700 text-base md:text-lg mb-4">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö</p>

    <div class="space-y-4 text-gray-800">
      <div>
        <h3 class="font-semibold text-blue-700 mb-1">üìú 1. ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</h3>
        <ul class="list-disc pl-6">
          <li>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö Latbualuang iCARE+ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°</li>
          <li>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏Ñ‡∏£‡∏π ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</li>
          <li>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏ò‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ï‡πà‡∏≠‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
        </ul>
      </div>

      <div>
        <h3 class="font-semibold text-blue-700 mb-1">üì¶ 2. ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ</h3>
        <ul class="list-disc pl-6">
          <li>‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ ‡∏Ñ‡∏£‡∏π ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</li>
          <li>‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∏‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô, ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö, ‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô, ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å, ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•, ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</li>
        </ul>
      </div>

      <div>
        <h3 class="font-semibold text-blue-700 mb-1">üõ°Ô∏è 3. ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Security Principles)</h3>
        <ul class="list-disc pl-6">
          <li><strong>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</strong>: ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (PDPA) ‡πÅ‡∏•‡∏∞‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á / ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
          <li><strong>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (Access Control)</strong>: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï / ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡∏≤‡∏°‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</li>
          <li><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢</strong>: ‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ (Encryption) ‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï</li>
          <li><strong>‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</strong>: ‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏ö‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</li>
        </ul>
      </div>

      <div>
        <h3 class="font-semibold text-blue-700 mb-1">ü§ù 4. ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏° (Ethical Principles)</h3>
        <ul class="list-disc pl-6">
          <li><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™</strong>: ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå / ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™</li>
          <li><strong>‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏®‡∏£‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå</strong>: ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÅ‡∏Å‡∏•‡πâ‡∏á ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</li>
          <li><strong>‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ï‡πà‡∏≠‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö</strong>: ‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ú‡∏¥‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</li>
          <li><strong>‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ AI ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°</strong>: ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à ‡πÑ‡∏°‡πà‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</li>
        </ul>
      </div>

      <div>
        <h3 class="font-semibold text-blue-700 mb-1">üß≠ 5. ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ</h3>
        <ul class="list-disc pl-6">
          <li>‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£/‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏î‡∏π‡πÅ‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢</li>
          <li>‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (Audit Log)</li>
          <li>‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö ‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏Å‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ</li>
        </ul>
      </div>

      <div>
        <h3 class="font-semibold text-blue-700 mb-1">üîÑ 6. ‡∏Å‡∏≤‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</h3>
        <ul class="list-disc pl-6">
          <li>‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏õ‡∏µ‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
          <li>‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</li>
        </ul>
      </div>

      <p class="text-center text-gray-700 mt-4">
        üîê ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏£‡∏≤‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Latbualuang iCARE+ ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠ ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
      </p>
    </div>
  </div>
</div>
<script>
  // Open Policy Modal helper
  function openPolicyModal(){ document.getElementById('policyModal')?.classList.remove('hidden'); }
</script>


<script>
  window.onLoginSuccess = function(){
    var topAlert = document.getElementById('topAlert');
    if (topAlert) topAlert.style.display = 'none';
    var flo = document.getElementById('floatingLoginBtn');
    if (flo) flo.style.display = 'none';
  };
  (function(){
    try{
      var u = sessionStorage.getItem('userData');
      if (u) { window.onLoginSuccess(); }
    }catch(_){}
  })();
</script>


<script>
(function(){
  function isLoggedIn(){
    try { return !!sessionStorage.getItem('userData'); } catch(e){ return false; }
  }
  function isAllowedTarget(el){
    if (!el) return true;
    // Allow: login modal & button & register opens
    if (el.id === 'floatingLoginBtn') return true;
    if (el.id === 'registerDropdownBtn') return true;
    if (el.closest && (el.closest('#loginModal') || el.closest('#studentModal') || el.closest('#teacherModal') || el.closest('#dropdownMenu'))) return true;
    // Allow header login button by checking its onclick opening loginModal
    const txt = (el.textContent||'').trim();
    if (/^üîê\s*Login$/.test(txt) || /‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö/.test(txt) || /‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô/.test(txt)) {
      // only allow those that actually open / relate to login/register
      return true;
    }
    return false;
  }
  // Capture all clicks
  document.addEventListener('click', function(e){
    const btn = e.target.closest('button, a');
    if (!btn) return;
    if (isLoggedIn()) return;
    if (isAllowedTarget(btn)) return;
    e.preventDefault();
    e.stopImmediatePropagation();
    const lm = document.getElementById('loginModal');
    if (lm) lm.classList.remove('hidden');
  }, true);
})();
</script>

</body>
</html>

<script>
   function togglePassword(id) {
  const input = document.getElementById(id);
  input.type = input.type === "password" ? "text" : "password";
}
  </script>
<!-- üö® Emergency Report Modal (Step 1: UI only) -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden p-4" id="emergencyModal">
<div class="bg-red-100 rounded-2xl shadow-2xl w-full max-w-md relative overflow-y-auto max-h-screen p-6 font-mitr">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="closeModal('emergencyModal')">
     ‚úñ
    </button>
<h2 class="text-xl sm:text-2xl font-bold text-red-600 mb-4 text-center">
     üö®üÜò ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ôüö®
    </h2>
<p class="text-sm text-blue-700 mt-2 mb-2 font-mitr" id="reporterName">
 üë§ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏î‡∏¢: (‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á...)
</p>
<input id="ReportedBy" name="ReportedBy" type="hidden"/>
<form action="https://script.google.com/macros/s/AKfycbxLWBNIqSfa_88ONWAlsK-gNBLQZBVTOT4za3xWFANrZ-_6ZQgmtLD4VB4NlXo2Y6ZD/exec" class="space-y-3" enctype="multipart/form-data" id="emergencyForm" method="POST">
<!-- Displayed student info (to be filled in dynamically after login) -->
<!-- Emergency Type Dropdown -->
<div>
<label class="block text-sm">
       ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô:
      </label>
<select class="w-full px-3 py-2 rounded border text-black bg-white" id="emergencyType" name="EmergencyType" onchange="this.style.color='#000';" style="color:#60A5FA;">
<option disabled="" selected="" value="">
        -- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏ --
       </option>
<optgroup label="üî¥ ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢" style="background-color:#fecaca;">
<option style="background-color:#fee2e2;">
         üí• ‡∏û‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
        </option>
<option style="background-color:#fee2e2;">
         üëä ‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏ß‡∏¥‡∏ß‡∏≤‡∏ó / ‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Å‡∏±‡∏ô
        </option>
<option style="background-color:#fee2e2;">
         üò¢ ‡∏ñ‡∏π‡∏Å‡∏£‡∏±‡∏á‡πÅ‡∏Å / ‡∏ö‡∏π‡∏•‡∏•‡∏µ‡πà (Bullying)
        </option>
<option style="background-color:#fee2e2;">
         üö¨ ‡∏û‡∏ö‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î / ‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå / ‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà
        </option>
<option style="background-color:#fee2e2;">
         üìµ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÅ‡∏Å‡∏•‡πâ‡∏á‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
        </option>
</optgroup>
<optgroup label="üü† ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô" style="background-color:#fed7aa;">
<option style="background-color:#ffedd5;">
         ü§¢ ‡∏õ‡πà‡∏ß‡∏¢‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô / ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏° / ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ / ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å
        </option>
<option style="background-color:#ffedd5;">
         üß† ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á / ‡∏ß‡∏¥‡∏ï‡∏Å‡∏Å‡∏±‡∏á‡∏ß‡∏• / ‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå
        </option>
<option style="background-color:#ffedd5;">
         ü©π ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏ / ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° / ‡∏•‡∏∑‡πà‡∏ô‡∏•‡πâ‡∏°
        </option>
</optgroup>
<optgroup label="üü° ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà" style="background-color:#fef08a;">
<option style="background-color:#fef9c3;">
         üî• ‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ / ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÑ‡∏´‡∏°‡πâ / ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏•‡∏±‡∏î‡∏ß‡∏á‡∏à‡∏£
        </option>
<option style="background-color:#fef9c3;">
         ‚ö†Ô∏è ‡∏û‡∏ö‡∏Ñ‡∏ô‡πÅ‡∏õ‡∏•‡∏Å‡∏´‡∏ô‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏ö‡∏∏‡∏Å‡∏£‡∏∏‡∏Å‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </option>
<option style="background-color:#fef9c3;">
         üßØ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå / ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πà‡∏ô‡∏ä‡∏≥‡∏£‡∏∏‡∏î
        </option>
<option style="background-color:#fef9c3;">
         üö∂‚Äç‚ôÇÔ∏è ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏≤‡∏¢‡∏ï‡∏±‡∏ß / ‡πÄ‡∏î‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </option>
</optgroup>
<optgroup label="üü¢ ‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" style="background-color:#bbf7d0;">
<option style="background-color:#dcfce7;" value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)">
         üí¨ ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)
        </option>
</optgroup>
</select>
<input class="mt-2 w-full px-3 py-2 rounded border text-black hidden" id="otherEmergencyInput" name="OtherEmergencyDetail" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." type="text"/>
</div>
<!-- Location -->
<div>
<label class="block text-sm">
       ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏:
      </label>
<input class="w-full px-3 py-2 rounded border text-black" name="Location" required="" type="text"/>
</div>
<!-- File Uploads -->
<div>
<label class="block text-sm text-black">
       ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="imageFile" accept="image/*"/>
<label class="block text-sm mt-2 text-black" style="color:#000 !important;">
       ‡πÅ‡∏ô‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡πÄ‡∏™‡∏µ‡∏¢‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="audioFile" accept="audio/*"/>
<label class="block text-sm mt-2 text-black" style="color:#000 !important;">
       ‡πÅ‡∏ô‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="videoFile" accept="video/*"/>
<p class="text-xs text-gray-600 mt-1">
       ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏ß‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB
      </p>
</div>
<!-- Confirmation -->
<label class="inline-flex items-start text-sm text-gray-700">
<input class="mr-2 mt-1" required="" type="checkbox"/>
      ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ß‡πà‡∏≤ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£
     </label>
<p class="text-xs text-red-500 italic">
      üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô
     </p>
<!-- Submit -->
<div class="text-center pt-2">
<button class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded" type="submit">
       ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏
      </button>
<p class="text-sm mt-2" id="emergencyStatus">
</p>
</div>
</form>
</div>
</div>
<script>
   function toggleOtherInput(value) {
  const input = document.getElementById("otherEmergencyInput");
  input.classList.toggle("hidden", value !== "‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)");
}
  </script>
<!-- ‚úÖ New Login Modal -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" id="loginModal">
<div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-sm relative font-mitr">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="document.getElementById('loginModal').classList.add('hidden')">
     ‚úñ
    </button>
<h2 class="text-xl font-bold mb-4 text-yellow-600">
     üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
    </h2>
<form class="space-y-3" id="loginForm">
<input class="w-full px-3 py-2 rounded border" name="Username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required="" type="text"/>
<input class="w-full px-3 py-2 rounded border" name="Password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required="" type="password"/>
<button class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded" type="submit">
      ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
     </button>
<p class="text-center text-sm mt-2 text-red-600" id="loginStatus">
</p>
</form>
</div>
</div>
<!-- ‚úÖ Login Script -->
<script>
   const loginScriptURL = "https://script.google.com/macros/s/AKfycbw7X3QPSj76DJR9eelvRI73MGZIltO_WX1g2OdQ5RIAhfxs_6ecBwJZa6V_qImLctIHuA/exec";

  document.getElementById("loginForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const username = this.Username.value.trim();
    const password = this.Password.value.trim();
    const formData = new FormData();
    formData.append("Username", username);
    formData.append("username", username);
    formData.append("Password", password);
    formData.append("password", password);
    formData.append("IP_Address", "Auto");
    formData.append("ip", "Auto");
    formData.append("Device", navigator.userAgent);
    formData.append("device", navigator.userAgent);

    fetch(loginScriptURL, {
      method: "POST",
      body: formData,
    })
    .then((res) => res.json())
    .then((data) => {
      const ok = data && (data.success === true || data.status === 'success');
      if (ok) {
        sessionStorage.setItem("userData", JSON.stringify(data));
        document.getElementById("loginStatus").textContent = "‚úÖ üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        document.getElementById("loginModal").classList.add("hidden");
        enableProtectedFeatures(); if(window.onLoginSuccess){ try{ window.onLoginSuccess(); }catch(_){} }
alert(`‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${data.Prefix}${data.FirstName} ${data.LastName}`);
      } else {
        document.getElementById("loginStatus").textContent = "‚ùå " + data.message;
      }
    })
    .catch((err) => {
      document.getElementById("loginStatus").textContent = "‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message;
    });
  });

  function enableProtectedFeatures() {
    const protectedButtons = document.querySelectorAll(".protected-button, .protected-form");
    protectedButtons.forEach(btn => {
      btn.disabled = false;
      btn.classList.remove("opacity-50", "pointer-events-none");
    });
  }

  window.onload = function () {
    const user = sessionStorage.getItem("userData");
    if (!user) {
      const protectedButtons = document.querySelectorAll(".protected-button, .protected-form");
      protectedButtons.forEach(btn => {
        btn.disabled = true;
        btn.classList.add("opacity-50", "pointer-events-none");
      });
    } else {
      enableProtectedFeatures(); if(window.onLoginSuccess){ try{ window.onLoginSuccess(); }catch(_){} }
}
  };
  </script>
<script>
   document.addEventListener("DOMContentLoaded", () => {
  const user = sessionStorage.getItem("userData");
  if (user) {
    const userObj = JSON.parse(user);
    const fullName = `${userObj.Prefix}${userObj.FirstName} ${userObj.LastName} | ${userObj.Class}/${userObj.Room}`;
    const userDisplay = document.getElementById("userDisplay");
    if (userDisplay) {
      userDisplay.textContent = `üëã ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö: ${fullName}`;
      userDisplay.classList.remove("hidden");
    }
  }
});
  </script>
<!-- Student Registration Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center" id="studentModal">
<div class="bg-white w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-xl p-6 font-[Mitr] relative">
<button class="absolute top-2 right-3 text-xl" onclick="document.getElementById('studentModal').classList.add('hidden')">
     ‚úñ
    </button>
<h2 class="text-blue-600 text-xl font-semibold mb-4">
     üë®‚Äçüéì ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
    </h2>
<form class="space-y-4" enctype="multipart/form-data" id="studentForm" method="post" onsubmit="return validateForm(event)" onsubmit="return validateForm(event)">
<!-- Student Info -->
<fieldset class="bg-blue-50 rounded p-4">
<legend class="text-blue-700 font-semibold">
       üßë‚Äçüéì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
      </legend>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="StudentID" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" required=""/>
<select class="text-black block w-full border rounded px-3 py-2" name="Prefix_Student" onchange="this.style.color='#000';" required="" style="color:#60A5FA;">
<option value="">
        -- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --
       </option>
<option>
        ‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢
       </option>
<option>
        ‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á
       </option>
<option>
        ‡∏ô‡∏≤‡∏¢
       </option>
<option>
        ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß
       </option>
</select>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="FirstName_Student" placeholder="‡∏ä‡∏∑‡πà‡∏≠" required=""/>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="LastName_Student" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required=""/>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="Nickname" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô" required=""/>
<select class="text-black block w-full border rounded px-3 py-2" name="Class" onchange="this.style.color='#000';" required="" style="color:#60A5FA;">
<option value="">
        -- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --
       </option>
<option>
        1
       </option>
<option>
        2
       </option>
<option>
        3
       </option>
<option>
        4
       </option>
<option>
        5
       </option>
<option>
        6
       </option>
<option>
        ‡∏õ‡∏ß‡∏ä.
       </option>
</select>
<select class="text-black block w-full border rounded px-3 py-2" name="Room" onchange="this.style.color='#000';" required="" style="color:#60A5FA;">
<option value="">
        -- ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --
       </option>
<option>
        1
       </option>
<option>
        2
       </option>
<option>
        3
       </option>
<option>
        4
       </option>
</select>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" id="birthdate" name="Birthdate" placeholder="‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ" required="" type="text"/>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="StudentPhone" pattern="\d{10}" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (10 ‡∏´‡∏•‡∏±‡∏Å)" required=""/>
</fieldset>
<!-- Parent Info -->
<fieldset class="bg-green-50 rounded p-4">
<legend class="text-green-700 font-semibold">
       üë®‚Äçüë©‚Äçüëß‚Äçüë¶ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á
      </legend>
<select class="text-black block w-full border rounded px-3 py-2" name="Prefix_Parent" onchange="this.style.color='#000';" required="" style="color:#60A5FA;">
<option value="">
        -- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --
       </option>
<option>
        ‡∏ô‡∏≤‡∏¢
       </option>
<option>
        ‡∏ô‡∏≤‡∏á
       </option>
<option>
        ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß
       </option>
</select>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="FirstName_Parent" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á" required=""/>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="LastName_Parent" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á" required=""/>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="ParentPhone" pattern="\d{10}" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á (10 ‡∏´‡∏•‡∏±‡∏Å)" required=""/>
</fieldset>
<!-- Account Info -->
<fieldset class="bg-gray-50 rounded p-4">
<legend class="text-gray-700 font-semibold">
       üë§ ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
      </legend>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" name="Username" placeholder="üÜî Username" required=""/>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" maxlength="6" minlength="6" name="Password" pattern="[A-Za-z0-9]{6}" placeholder="üîë Password (6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£/‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)" required="" type="password"/>
<input class="text-black placeholder-blue-300 block w-full border rounded px-3 py-2" maxlength="6" minlength="6" name="ConfirmPassword" placeholder="Confirm Password" required="" type="password"/>
</fieldset>
<div class="text-sm mt-2 text-center" id="formMessage">
</div>
<div style="text-align: center; margin-top: 20px;">
<button class="w-full hover:bg-blue-200 text-blue-700 py-2 px-4 rounded bg-blue-600 text-white hover:bg-blue-700 px-4 py-2 rounded" style="width: auto; white-space: nowrap;" type="submit">
       ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      </button>
</div>
</form>
</div>
</div>
<script>
function validateForm(event) {
  event.preventDefault();
  const form = event.target;
  const message = document.getElementById('formMessage');

  // Basic validations
  if (form.Password.value !== form.ConfirmPassword.value) {
    message.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô";
    message.className = "text-red-600";
    return false;
  }

  // Build payload and send to Apps Script
  const formData = new FormData(form);
  fetch("https://script.google.com/macros/s/AKfycbxdY__BNd_oV2kTNa4rT7lS0YaHJHwRPGCHCR9PmcPBfKnTXZfLWXbx1Nf1FslsRuUH/exec", {
    method: "POST",
    body: formData
  })
  .then(res => res.text())
  .then(msg => {
     + msg;
    message.className = "text-green-600";
    form.reset();
  })
  .catch((err) => {
    message.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: " + err.message;
    message.className = "text-red-600";
  });
  return false;
}
</script>

<script>
function validateTeacherForm(event) {
  event.preventDefault();
  const form = event.target;
  const msg = document.getElementById('teacherFormMessage');

  // Clear previous state
  msg.textContent = "";
  msg.className = "";

  // Pull values
  const prefix = form.querySelector('[name="Prefix_Teacher"]')?.value.trim();
  const firstName = form.querySelector('[name="FirstName_Teacher"]')?.value.trim();
  const lastName = form.querySelector('[name="LastName_Teacher"]')?.value.trim();
  const nick = form.Nickname?.value.trim();
  const subject = form.SubjectGroup?.value.trim();
  const phone = form.Phone?.value.trim();
  const lineId = form.LineID?.value.trim();
  const email = form.Email?.value.trim();
  const username = form.Username?.value.trim();
  const password = form.Password?.value;
  const confirm = form.ConfirmPassword?.value;

  // Front-end required checks
  const required = [
    ['‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤', prefix],
    ['‡∏ä‡∏∑‡πà‡∏≠', firstName],
    ['‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', lastName],
    ['‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô', nick],
    ['‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞/‡∏ù‡πà‡∏≤‡∏¢', subject],
    ['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå', phone],
    ['Line ID', lineId],
    ['‡∏≠‡∏µ‡πÄ‡∏°‡∏•', email],
    ['Username', username],
    ['Password', password],
    ['ConfirmPassword', confirm]
  ];

  for (const [label, val] of required) {
    if (!val) {
      msg.textContent = "‚ùå ‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á (" + label + ")";
      msg.className = "text-red-600";
      return false;
    }
  }

  if (!/^\d{10}$/.test(phone)) {
    msg.textContent = "‚ùå ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 10 ‡∏´‡∏•‡∏±‡∏Å";
    msg.className = "text-red-600";
    return false;
  }

  if (!/^[A-Za-z0-9]{6}$/.test(password)) {
    msg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£/‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 6 ‡∏ï‡∏±‡∏ß";
    msg.className = "text-red-600";
    return false;
  }

  if (password !== confirm) {
    msg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô";
    msg.className = "text-red-600";
    return false;
  }

  // Build payload for Apps Script (multipart/form-data)
  const fd = new FormData();
  fd.append("Timestamp", new Date().toISOString());
  fd.append("Prefix_Teacher", prefix);
  fd.append("FirstName_Teacher", firstName);
  fd.append("LastName_Teacher", lastName);
  fd.append("Nickname", nick);
  fd.append("SubjectGroup", subject);
  fd.append("Phone", phone);
  fd.append("LineID", lineId);
  fd.append("Email", email);
  fd.append("Username", username);
  fd.append("Password", password);
  fd.append("ConfirmPassword", confirm);

  // Send to the provided Apps Script URL
  const TEACHER_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxdY__BNd_oV2kTNa4rT7lS0YaHJHwRPGCHCR9PmcPBfKnTXZfLWXbx1Nf1FslsRuUH/exec";

  fetch(TEACHER_SCRIPT_URL, {
    method: "POST",
    body: fd
  })
  .then(async (res) => {
    const text = await res.text().catch(() => "");
    if (res.ok) {
      msg.textContent = "‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
      msg.className = "text-green-600";
      form.reset();
    } else {
      msg.textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (text || res.status);
      msg.className = "text-red-600";
    }
  })
  .catch((err) => {
    msg.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: " + err.message;
    msg.className = "text-red-600";
  });

  return false;
}
</script>

<script>
   document.querySelectorAll('a').forEach(el => {
  if (el.textContent.includes("üßë‚Äçüéì ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô")) {
    el.setAttribute("onclick", "document.getElementById('studentModal').classList.remove('hidden')");
  }
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll("select option").forEach(opt => {
    const text = opt.textContent.trim();
    if (["‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢", "‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á", "‡∏ô‡∏≤‡∏¢", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", "-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --"].includes(text)) {
      opt.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll("select option").forEach(opt => {
    const text = opt.textContent.trim();
    if (text) {
      opt.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  const placeholders = ["‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤", "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô", "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];
  document.querySelectorAll("input[placeholder], select[placeholder]").forEach(el => {
    if (placeholders.includes(el.placeholder.trim())) {
      el.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  const targets = ["-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --", "-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --", "-- ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];

  // Set color for placeholder-like options in select dropdowns
  document.querySelectorAll("select option").forEach(option => {
    if (targets.includes(option.textContent.trim())) {
      option.style.color = "#60A5FA";
    }
  });

  // Set color for placeholder in input fields
  document.querySelectorAll("input[placeholder]").forEach(input => {
    if (targets.includes(input.placeholder.trim())) {
      input.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  const blueOptions = ["-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --", "-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --", "-- ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];
  document.querySelectorAll("select option").forEach(opt => {
    if (blueOptions.includes(opt.textContent.trim())) {
      opt.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   flatpickr("#birthdate", {
    dateFormat: "d/m/Y",
    locale: "th",
    allowInput: true
  });
  </script>
<!-- üë®‚Äçüè´ Teacher Registration Modal (Updated) -->
<div class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center" id="teacherModal">
<div class="bg-white w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-xl p-6 font-[Mitr] relative">
<button class="absolute top-2 right-3 text-xl" onclick="document.getElementById('teacherModal').classList.add('hidden')">
     ‚úñ
    </button>
<h2 class="text-blue-600 text-xl font-semibold mb-4">
     üë®‚Äçüè´ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏π
    </h2>
<form class="space-y-4" enctype="multipart/form-data" id="teacherForm" method="post" onsubmit="return validateTeacherForm(event)">
<fieldset class="bg-green-50 rounded p-4">
<legend class="text-green-700 font-semibold">
       üë©‚Äçüè´ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏π
      </legend>
<select class="text-black block w-full border rounded px-3 py-2" id="PrefixSelect" name="Prefix_Teacher" onchange="updateSelectColor(this)" required="" style="color:#60A5FA;">
<option disabled="True" hidden="True" selected="True" style="color:#60A5FA;" value="">
        -- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --
       </option>
<option value="‡∏ô‡∏≤‡∏¢">
        ‡∏ô‡∏≤‡∏¢
       </option>
<option value="‡∏ô‡∏≤‡∏á">
        ‡∏ô‡∏≤‡∏á
       </option>
<option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">
        ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß
       </option>
</select>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" name="FirstName_Teacher" placeholder="‡∏ä‡∏∑‡πà‡∏≠" required=""/>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" name="LastName_Teacher" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required=""/>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" name="Nickname" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô" required=""/>
<select class="text-black block w-full border rounded px-3 py-2" id="SubjectGroupSelect" name="SubjectGroup" onchange="updateSelectColor(this)" required="" style="color:#60A5FA;">
<option disabled="True" hidden="True" selected="True" style="color:#60A5FA;" value="">
        -- ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Ø/‡∏ù‡πà‡∏≤‡∏¢ --
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏™‡∏∏‡∏Ç‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏®‡∏∂‡∏Å‡∏©‡∏≤">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏™‡∏∏‡∏Ç‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏®‡∏∂‡∏Å‡∏©‡∏≤
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏®‡∏¥‡∏•‡∏õ‡∏∞">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏®‡∏¥‡∏•‡∏õ‡∏∞
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏û">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏û
       </option>
<option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®">
        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
</option>
<option value="‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û(‡∏õ‡∏ß‡∏ä.)">
        ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û(‡∏õ‡∏ß‡∏ä.)
       </option>
<option value="‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£">
        ‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
       </option>
<option value="‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤">
        ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
       </option>
</select>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" name="Phone" pattern="\d{10}" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Ñ‡∏£‡∏π 10 ‡∏´‡∏•‡∏±‡∏Å" required=""/>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" name="Email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" required="" type="email"/>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" name="LineID" placeholder="Line ID" required=""/>
</fieldset>
<fieldset class="bg-gray-50 rounded p-4">
<legend class="text-gray-700 font-semibold">
       üë§ ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
      </legend>
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" name="Username" placeholder="üÜî Username" required=""/>
<div class="relative">
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" id="PasswordTeacher" maxlength="6" minlength="6" name="Password" pattern="[A-Za-z0-9]{6}" placeholder="üîë Password" required="" type="password"/>
<button class="absolute top-2 right-2 text-sm" onclick="togglePassword('PasswordTeacher')" type="button">
        üëÅÔ∏è
       </button>
</div>
<div class="relative">
<input class="text-black placeholder-blue-400 block w-full border rounded px-3 py-2" id="ConfirmPasswordTeacher" maxlength="6" minlength="6" name="ConfirmPassword" placeholder="ConfirmPassword" required="" type="password"/>
<button class="absolute top-2 right-2 text-sm" onclick="togglePassword('ConfirmPasswordTeacher')" type="button">
        üëÅÔ∏è
       </button>
</div>
</fieldset>
<div class="text-sm mt-2 text-center" id="teacherFormMessage">
</div>
<div class="text-center mt-4">
<button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded" type="submit">
       ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      </button>
</div>
</form>
</div>
</div>
<script>
   function updateSelectColor(select) {
  if (select.value === "") {
    select.style.color = "#60A5FA";
  } else {
    select.style.color = "#000";
  }
}
document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll("select").forEach(select => {
    updateSelectColor(select);
  });
});
  </script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const photoInput = document.getElementById("TeacherPhoto");
  const statusDiv = document.getElementById("teacherFormMessage");

  if (photoInput) {
    photoInput.addEventListener("change", function () {
      const file = this.files[0];
      if (file && file.size > 1024 * 1024) {
        statusDiv.textContent = "‚ùå ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1MB";
        statusDiv.className = "text-red-600";
        this.value = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤
      } else {
        statusDiv.textContent = "";
        statusDiv.className = "";
      }
    });
  }
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const user = JSON.parse(sessionStorage.getItem("userData") || "{}");

  const fullName = `${user.Prefix || ""}${user.FirstName || ""} ${user.LastName || ""}`.trim();
  const classroom = user.Class && user.Room ? ` ‡∏°.${user.Class}/${user.Room}` : "";
  const displayName = fullName + classroom;

  // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô UI
  const display = document.getElementById("reporterName");
  if (display) {
    display.textContent = "üë§ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏î‡∏¢: " + displayName;
  }

  // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤ hidden input ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÉ‡∏ô Google Sheet
  const input = document.getElementById("ReportedBy");
  if (input) {
    input.value = displayName;
  }
});
</script>

<!-- üìû iCARE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠ Modal -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden p-4" id="icareListenModal">
<div class="bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto p-6 font-mitr relative">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="document.getElementById('icareListenModal').classList.add('hidden')">‚úñ</button>
<h2 class="text-2xl font-bold text-center mb-4 text-green-600">üìû iCARE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠</h2>
<form class="space-y-4" id="icareListenForm">
<div>
<label class="block text-sm font-mitr" for="icareReason" style="color:#60D9A3;">‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</label>
<select class="w-full px-3 py-2 rounded border text-black bg-white font-mitr" id="icareReason" name="icareReason" onchange="this.style.color='#000';" required="" style="color:#60D9A3;">
<option disabled="" selected="" value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• --</option>
<option>üòä ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏Ñ‡∏£‡∏™‡∏±‡∏Å‡∏Ñ‡∏ô‡∏ü‡∏±‡∏á (‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ ‡πÅ‡∏Ñ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πá‡∏û‡∏≠‡πÅ‡∏•‡πâ‡∏ß)</option>
<option>üë©‚Äçüè´ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</option>
<option>üìû ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö (‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ)</option>
<option>ü§ù ‡∏≠‡∏¢‡∏≤‡∏Å‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á (‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡∏≤‡∏ö‡πâ‡∏≤‡∏á ‡∏Å‡πá‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ô‡∏≠‡∏∞)</option>
<option>üë®‚Äçüíº ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏• (‡∏ö‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠)</option>
<option>‚úçÔ∏è ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)</option>
</select>
</div>
<div>
<label class="block text-sm text-gray-700 font-mitr" for="icareDetails">‚úçÔ∏è ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
<textarea class="w-full px-3 py-2 rounded border text-black font-mitr min-h-[150px]" id="icareDetails" name="icareDetails" placeholder="" rows="6" style="resize: none;" required=""></textarea>
</div>
<p class="text-sm text-gray-600 mt-2 font-mitr">üîê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
<p class="text-sm text-green-600 italic font-mitr">üôè ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏à üíõ ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏û‡∏±‡∏á ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏™‡∏°‡∏≠</p>
<div class="text-center">
<button class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded font-mitr" style="width: auto;" type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
<p class="text-sm mt-2 font-mitr" id="icareListenStatus"></p>
</div>
</form>
</div>
</div>
<script>
  document.getElementById("icareListenForm")?.addEventListener("submit", function (e) {
    e.preventDefault();
    const status = document.getElementById("icareListenStatus");
    status.textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
    status.className = "text-green-600";
    this.reset();
  });
</script>
<!-- Emotion Assessment Modal -->
<script>
function showEmotionModal() {
  const modal = document.getElementById("emotionModal");
  if (modal) {
    modal.style.display = "flex";
  }
}

function hideEmotionModal() {
  const modal = document.getElementById("emotionModal");
  if (modal) {
    modal.style.display = "none";
  }
}

window.addEventListener("click", function (event) {
  const modal = document.getElementById("emotionModal");
  if (event.target === modal) {
    hideEmotionModal();
  }
});
</script>
<!-- üíó ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏• Modal (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß) -->
<!-- üíó ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏• Modal (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô) -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4" id="emotionModal">
<div class="modal-content relative font-mitr max-h-[90vh] overflow-y-auto">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black text-2xl" onclick="hideEmotionModal()">‚úñ</button>
<h2 class="text-xl font-bold text-pink-600 text-center mb-2">üíó ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•</h2>
<p class="text-sm text-cyan-600 text-right mb-4">üïí ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ô‡∏≤‡∏ó‡∏µ üíô</p>
<form id="emotionForm">
<fieldset style="background-color: #c8f7c5; border: none; padding: 15px; margin-top: 10px;">
<legend style="background-color: #66bb6a; padding: 5px 10px; color: white; border-radius: 5px;">‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á?</legend>
<p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏¥‡∏î‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏¢‡∏ô‡∏∞</p>
<label>1. üòä ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üòÑ ‡πÉ‡∏ä‡πà‡πÄ‡∏•‡∏¢ / ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option><option>üôÇ ‡∏ö‡πà‡∏≠‡∏¢</option><option>üòê ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á</option><option>üòû ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option></select><br/><br/>
<label>2. üè´ ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>ü•∞ ‡πÉ‡∏ä‡πà‡πÄ‡∏•‡∏¢ / ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option><option>üòä ‡∏ö‡πà‡∏≠‡∏¢</option><option>üòê ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á</option><option>üôÅ ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option></select><br/><br/>
<label>3. üé® ‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏™‡∏ô‡∏∏‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏á‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>ü§© ‡πÉ‡∏ä‡πà‡πÄ‡∏•‡∏¢ / ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option><option>üòÉ ‡∏ö‡πà‡∏≠‡∏¢</option><option>üòê ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á</option><option>üò© ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option></select><br/><br/>
<label>4. üò¥ ‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏û‡∏≠‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üõå ‡∏´‡∏•‡∏±‡∏ö‡∏™‡∏ö‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏∑‡∏ô</option><option>üòå ‡∏´‡∏•‡∏±‡∏ö‡∏î‡∏µ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option><option>üòï ‡∏´‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏û‡∏≠</option><option>üò´ ‡∏´‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏î‡∏µ‡πÄ‡∏•‡∏¢</option></select><br/><br/>
<label>5. üíñ ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üåü ‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢ ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡πà‡∏≤</option><option>üòä ‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£</option><option>üòê ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à</option><option>üòû ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option></select>
</fieldset>
<fieldset style="background-color: #ffe0b2; border: none; padding: 15px; margin-top: 10px;">
<legend style="background-color: #fb8c00; padding: 5px 10px; color: white; border-radius: 5px;">‚ö†Ô∏è ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÑ‡∏´‡∏°?</legend>
<label>6. üßç ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏•‡∏¢‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üòÑ ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option><option>üôÇ ‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ</option><option>üòï ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á / ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏¢</option><option>üò¢ ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option></select><br/><br/>
<label>7. üíî ‡πÄ‡∏Ñ‡∏¢‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡πÇ‡∏•‡∏Å‡∏ô‡∏µ‡πâ‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üòÑ ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option><option>üôÇ ‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ</option><option>üòï ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á / ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏¢</option><option>üò¢ ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option></select><br/><br/>
<label>8. üìö ‡πÑ‡∏°‡πà‡∏Å‡∏•‡πâ‡∏≤‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏á‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üòÑ ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option><option>üôÇ ‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ</option><option>üòï ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á / ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏¢</option><option>üò¢ ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option></select><br/><br/>
<label>9. üòî ‡πÄ‡∏Ñ‡∏¢‡πÇ‡∏î‡∏ô‡∏•‡πâ‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üòÑ ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option><option>üôÇ ‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ</option><option>üòï ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á / ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏¢</option><option>üò¢ ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option></select><br/><br/>
<label>10. üò§ ‡πÇ‡∏Å‡∏£‡∏ò‡∏á‡πà‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î‡∏ö‡πà‡∏≠‡∏¢‡∏à‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°</label>
<br/> <select required="required"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>üòÑ ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢</option><option>üôÇ ‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ</option><option>üòï ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á / ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏¢</option><option>üò¢ ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡πÅ‡∏ó‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option></select>
</fieldset>
<fieldset style="background-color: #b2ebf2; border: none; padding: 15px; margin-top: 10px;">
<legend style="background-color: #4dd0e1; padding: 5px 10px; color: white; border-radius: 5px;">üí¨ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏£‡∏π‡πÑ‡∏´‡∏°?</legend>
<label for="message">‚úçÔ∏è ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 150 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</label><br/>
<textarea id="message" maxlength="150" name="message" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢ / ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏≠‡∏ö‡πà‡∏≠‡∏¢‡πÜ / ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏¢ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô" required="required" rows="3" style="resize: none; width: 100%; box-sizing: border-box;"></textarea>
</fieldset>
<p id="submitStatus" style="margin-top: 15px;"></p>
<button style="margin-top: 10px; background-color: #4CAF50; color: white; padding: 10px 16px; border: none; border-radius: 6px; background-color: #e91e63 !important; display: block; margin: 20px auto;" type="submit">‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</button>
</form>
<p class="text-sm mt-2 text-center text-green-600" id="submitStatus"></p>
</div>
</div>
<script>
  function showEmotionModal() {
    document.getElementById("emotionModal").classList.remove("hidden");
  }

  function hideEmotionModal() {
    document.getElementById("emotionModal").classList.add("hidden");
  }

  window.addEventListener("click", function(event) {
    const modal = document.getElementById("emotionModal");
    if (event.target === modal) {
      hideEmotionModal();
    }
  });

  document.getElementById("emotionForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const form = e.target;
    const requiredFields = form.querySelectorAll("select[required], textarea[required]");
    let allFilled = true;
    requiredFields.forEach(field => {
      if (!field.value.trim()) {
        allFilled = false;
      }
    });
    const status = document.getElementById("submitStatus");
    if (!allFilled) {
      status.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠";
      status.className = "text-red-600 text-center mt-2";
    } else {
      status.textContent = "‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
      status.className = "text-green-600 text-center mt-2";
      form.reset();
    }
  });
</script>
<!-- ‚úÖ Modal ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á -->
<div class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-60 z-50" id="riskMapModal" style="display:none;">
<div class="bg-white rounded-lg shadow-lg relative w-[90%] max-w-2xl">
<button class="absolute top-2 left-2 text-lg font-bold text-red-600 hover:text-red-800 bg-white rounded-full w-8 h-8 flex items-center justify-center" onclick="document.getElementById('riskMapModal').style.display='none'">‚ùå</button>
<img alt="‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á iCARE" class="w-full h-auto rounded-b-lg" src="https://img5.pic.in.th/file/secure-sv1/Ladbualuang-iCARE-Risk--Alert-Map-v.26b9ee13c02bbf2f9.png"/>
</div>
</div>
<section style="background-color:#dbeafe;padding:20px;border-radius:20px;margin-top:30px;">
<h2 style="text-align:center;font-size:28px;color:#1d4ed8;font-weight:bold;">‚ú® ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤ ‚ú®</h2>
<form>
<div style="display:flex;gap:10px;margin-top:10px;">
<div style="flex:1;">
<label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
<input style="width:100%;padding:10px;border-radius:10px;border:1px solid #ccc;" type="text"/>
</div>
<div style="flex:1;">
<label>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á *</label>
<select style="width:100%;padding:10px;border-radius:10px;border:1px solid #ccc;">
<option>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ --</option>
</select>
</div>
</div>
<div style="margin-top:10px;">
<label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î *</label>
<textarea style="width:100%;height:120px;padding:10px;border-radius:10px;border:1px solid #ccc; resize: none;"></textarea>
</div>
<div style="display:flex;gap:10px;margin-top:10px;">
<div style="flex:1;">
<label>‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
<input style="width:100%;padding:10px;border-radius:10px;border:1px solid #ccc;" type="email"/>
</div>
<div style="flex:1;">
<label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
<input style="width:100%;padding:10px;border-radius:10px;border:1px solid #ccc;" type="tel"/>
</div>
</div>
<div style="text-align:center;margin-top:20px;">
<button style="background-color:#2563eb;color:white;padding:12px 30px;border:none;border-radius:10px;font-weight:bold;font-size:16px;box-shadow:2px 2px 5px rgba(0,0,0,0.2);" type="submit">
        ‚ö†Ô∏è ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
      </button>
</div>
<p style="text-align:center;font-size:12px;margin-top:10px;">
      * ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
    </p>
</form>
</section>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const form = document.getElementById("studentRegisterForm");
  if (form) {
    form.addEventListener("submit", function (e) {
      e.preventDefault();
      const formData = new FormData(form);
      fetch("https://script.google.com/macros/s/AKfycbxdY__BNd_oV2kTNa4rT7lS0YaHJHwRPGCHCR9PmcPBfKnTXZfLWXbx1Nf1FslsRuUH/exec", {
        method: "POST",
        body: formData
      })
      .then(response => response.text())
      .then(msg => {
        document.getElementById("formMessage")?.textContent = msg;
      })
      .catch(error => {
        document.getElementById("formMessage")?.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
      });
    });
  }
});
</script>
<script>
// --- Emergency form wiring (validation + submit to GAS) ---
(function() {
  const form = document.getElementById("emergencyForm");
  if (!form) return;
  let statusEl = document.getElementById("emergencyStatus");
  if (!statusEl) { statusEl = document.createElement("p"); statusEl.id = "emergencyStatus"; statusEl.className = "text-sm mt-2"; form.appendChild(statusEl); }
  const typeSel = document.getElementById("emergencyType") || form.querySelector('[name="EmergencyType"], select[name="emergencyType"]');
  const locInput = form.querySelector('[name="Location"], #Location, input[name="location"]');
  const confirmBox = form.querySelector('input[type="checkbox"]');
  const otherInput = document.getElementById('otherEmergencyInput');

  if (typeSel && otherInput) {
    typeSel.addEventListener('change', function() {
      const show = (String(this.value||'').trim() === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)');
      otherInput.classList.toggle('hidden', !show);
      if (!show) otherInput.value = "";
    });
  }

  async function lookupStudentContext(username) {
    try {
      if (typeof loginScriptURL !== "string" || !loginScriptURL) return null;
      const params = new URLSearchParams(); params.append("action","lookup"); params.append("Username", username);
      const res = await fetch(loginScriptURL, { method: "POST", body: params });
      if (!res.ok) return null;
      const ct = res.headers.get("content-type")||"";
      if (ct.includes("application/json")) {
        const j = await res.json().catch(()=>null); return j && (j.data || j);
      } else { try { return JSON.parse(await res.text()); } catch(_) { return null; } }
    } catch(_) { return null; }
  }

  form.addEventListener("submit", async function(e) {
    e.preventDefault();
    statusEl.textContent = ""; statusEl.className = "text-sm mt-2";

    const typeVal = typeSel ? String(typeSel.value||"").trim() : "";
    const locVal  = locInput ? String(locInput.value||"").trim() : "";
    const agreed  = !!(confirmBox && confirmBox.checked);
    if (!typeVal) { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô"; statusEl.classList.add("text-red-600"); return; }
    if (!locVal)  { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏"; statusEl.classList.add("text-red-600"); return; }
    if (!agreed)  { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡πä‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£"; statusEl.classList.add("text-red-600"); return; }

    // size check <= 5MB
    const _fileInputs = form.querySelectorAll('input[type="file"]');
    let _totalBytes = 0; _fileInputs.forEach(inp => { Array.from(inp.files||[]).forEach(f => { _totalBytes += (f && f.size) ? f.size : 0; }); });
    if (_totalBytes > 5 * 1024 * 1024) { statusEl.textContent="‚ùå ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 5MB"; statusEl.classList.add("text-red-600"); return; }

    let session = null; try { session = JSON.parse(sessionStorage.getItem("userData") || "null"); } catch(_){}
    if (!session) { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏"; statusEl.classList.add("text-red-600"); return; }
    const usr = session && session.data ? session.data : session;
    const username = usr && (usr.Username || usr.username);
    if (!username) { statusEl.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà"; statusEl.classList.add("text-red-600"); return; }

    const fd = new FormData(form);
    fd.append("Username", username);

    let ctx = {
      StudentID: usr.StudentID,
      Prefix_Student: usr.Prefix_Student || usr.Prefix,
      FirstName_Student: usr.FirstName_Student || usr.FirstName,
      LastName_Student: usr.LastName_Student || usr.LastName,
      Class: usr.Class, Room: usr.Room, StudentPhone: usr.StudentPhone || usr.Phone
    };
    if (!ctx.StudentID || !ctx.FirstName_Student || !ctx.LastName_Student) {
      const looked = await lookupStudentContext(username);
      if (looked) {
        ctx.StudentID = ctx.StudentID || looked.StudentID || looked.studentId || "";
        ctx.Prefix_Student = ctx.Prefix_Student || looked.Prefix_Student || looked.Prefix || "";
        ctx.FirstName_Student = ctx.FirstName_Student || looked.FirstName_Student || looked.FirstName || "";
        ctx.LastName_Student  = ctx.LastName_Student  || looked.LastName_Student  || looked.LastName  || "";
        ctx.Class = ctx.Class || looked.Class || "";
        ctx.Room  = ctx.Room  || looked.Room  || "";
        ctx.StudentPhone = ctx.StudentPhone || looked.StudentPhone || looked.Phone || "";
      }
    }
    Object.keys(ctx).forEach(k => { if (ctx[k]) fd.append(k, String(ctx[k])); });

    fd.append("IP_Address","Auto"); fd.append("Device", navigator.userAgent); fd.append("Source","EmergencyForm");

    const url = form.action || "https://script.google.com/macros/s/AKfycbxLWBNIqSfa_88ONWAlsK-gNBLQZBVTOT4za3xWFANrZ-_6ZQgmtLD4VB4NlXo2Y6ZD/exec";
    try {
      const res = await fetch(url, { method:"POST", body: fd });
      const txt = await res.text().catch(()=> "");
      if (res.ok) {
        statusEl.textContent = "‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"; statusEl.classList.add("text-green-600");
        if (typeSel) typeSel.value=""; if (locInput) locInput.value=""; if (otherInput) { otherInput.value=""; otherInput.classList.add("hidden"); } if (confirmBox) confirmBox.checked=false;
      } else {
        statusEl.textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (txt || res.status); statusEl.classList.add("text-red-600");
      }
    } catch(err) {
      statusEl.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: " + err.message; statusEl.classList.add("text-red-600");
    }
  });
})();
</script>

<script>window.loginScriptURL="https://script.google.com/macros/s/AKfycbytXOkLNA8p-uIJI53L0xGzkOu8f76VSf5pj5kdCH5y7llpgEIQ8zm9rqHoNaxyzi937A/exec";</script>
<script>

(function(){
  const form = document.getElementById("icareListenForm");
  if (!form) return;

  // Add hidden iframe fallback target
  let iframe = document.getElementById("listenHiddenFrame");
  if (!iframe) {
    iframe = document.createElement("iframe");
    iframe.style.display = "none";
    iframe.id = "listenHiddenFrame";
    document.body.appendChild(iframe);
  }

  const statusEl = document.getElementById("icareListenStatus");
  const setStatus = (msg, ok)=>{
    if (!statusEl) return;
    statusEl.textContent = msg || "";
    statusEl.classList.remove("text-red-600","text-green-600");
    statusEl.classList.add(ok ? "text-green-600":"text-red-600");
  };

  function getValByPref(ids, names){
    for (const id of (ids||[])) {
      const el = document.getElementById(id);
      if (el && typeof el.value !== "undefined") return String(el.value||"").trim();
    }
    for (const nm of (names||[])) {
      const el = form.querySelector(`[name="${nm}"]`);
      if (el && typeof el.value !== "undefined") return String(el.value||"").trim();
    }
    return "";
  }

  form.addEventListener("submit", async function(e){
    e.preventDefault();
    e.stopImmediatePropagation();
    setStatus("", true);

    if (form.dataset.submitting === "1") return;
    form.dataset.submitting = "1";
    const submitBtn = form.querySelector('[type="submit"]');
    if (submitBtn) submitBtn.disabled = true;

    try {
      // Validate required fields in the form generically
      const requiredEls = form.querySelectorAll("[required]");
      for (const el of requiredEls) {
        if (!el.value || String(el.value).trim() === "") {
          setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á", false);
          if (submitBtn) submitBtn.disabled = false;
          form.dataset.submitting = "0";
          return;
        }
      }

      // Session / login data
      let sess = null;
      try { sess = JSON.parse(sessionStorage.getItem("userData") || "null"); } catch(_){}
      if (!sess) { try { sess = JSON.parse(localStorage.getItem("userData") || "null"); } catch(_){ } }
      if (!sess) { try { sess = JSON.parse(localStorage.getItem("studentData") || "null"); } catch(_){ } }

      const user = (sess && sess.data) ? sess.data : sess;
      const username = user && (user.Username || user.username);
      if (!username) {
        setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", false);
        if (submitBtn) submitBtn.disabled = false;
        form.dataset.submitting = "0";
        return;
      }

      // Gather values (support multiple DOM names/ids)
      const reason  = getValByPref(["icareReason"], ["ListenReason","reason"]);
      const details = getValByPref(["icareDetails"],["ListenDetails","details"]);
      if (!reason)  { setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£", false);  submitBtn && (submitBtn.disabled=false); form.dataset.submitting="0"; return; }
      if (!details) { setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°", false); submitBtn && (submitBtn.disabled=false); form.dataset.submitting="0"; return; }

      // Build payload
      const fd = new FormData();
      const rid = (crypto.randomUUID ? crypto.randomUUID() : Date.now().toString(36)+Math.random().toString(36).slice(2));
      fd.append("RequestID", rid);
      fd.append("Username", username);
      fd.append("ListenReason", reason);
      fd.append("ListenDetails", details);
      fd.append("Source", "ListenForm");
      fd.append("IP_Address", "Auto");
      fd.append("Device", navigator.userAgent);

      // pass student context if present
      const ctx = {
        StudentID: user && user.StudentID,
        Prefix_Student: (user && (user.Prefix_Student || user.Prefix)),
        FirstName_Student: (user && (user.FirstName_Student || user.FirstName)),
        LastName_Student:  (user && (user.LastName_Student  || user.LastName)),
        Class: user && user.Class,
        Room:  user && user.Room,
        StudentPhone: user && (user.StudentPhone || user.Phone)
      };
      Object.keys(ctx).forEach(k => { if (ctx[k]) fd.append(k, String(ctx[k])); });

      const ENDPOINT = "https://script.google.com/macros/s/AKfycbzejn_sGgjDfOYU5nNtOV8hsgESSL0Pc7747Da5kGjwJXhiGzkse13WBliJY9iSy8GV/exec";

      // Try normal fetch first
      let ok = false, txt = "";
      try {
        const resp = await fetch(ENDPOINT, { method: "POST", body: fd });
        txt = await resp.text().catch(()=> "");
        ok = resp.ok || (txt && /‚úÖ/.test(txt));
      } catch (err) {
        // ignore, will fallback
      }

      if (!ok) {
        // Hidden iframe fallback (classic HTML POST) to beat CORS/network oddities
        const tempForm = document.createElement("form");
        tempForm.action = ENDPOINT;
        tempForm.method = "POST";
        tempForm.enctype = "multipart/form-data";
        tempForm.target = "listenHiddenFrame";
        tempForm.style.display = "none";

        const add = (k,v)=>{
          const inp = document.createElement("input");
          inp.type = "hidden"; inp.name = k; inp.value = v;
          tempForm.appendChild(inp);
        };
        add("RequestID", rid);
        add("Username", username);
        add("ListenReason", reason);
        add("ListenDetails", details);
        add("Source", "ListenForm");
        add("IP_Address", "Auto");
        add("Device", navigator.userAgent);
        Object.keys(ctx).forEach(k => { if (ctx[k]) add(k, String(ctx[k])); });

        document.body.appendChild(tempForm);
        tempForm.submit();
        setTimeout(()=> { document.body.removeChild(tempForm); }, 2000);
        ok = true; // will rely on GAS idempotency
      }

      if (ok) {
        setStatus("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", true);
        form.reset();
      } else {
        setStatus("‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à " + (txt ? (": " + txt) : ""), false);
      }

    } catch (err) {
      setStatus("‚ùå ‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á: " + (err && err.message ? err.message : err), false);
    } finally {
      form.dataset.submitting = "0";
      const submitBtn2 = form.querySelector('[type="submit"]');
      if (submitBtn2) submitBtn2.disabled = false;
    }
  });
})();

</script>
</body>
</html>
<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>
   Latbualuang iCARE+ - ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤
  </title>
<script src="https://cdn.tailwindcss.com">
</script>
<link href="https://fonts.googleapis.com/css2?family=Mitr&amp;display=swap" rel="stylesheet"/>
<style>
   .font-mitr { font-family: "Mitr", sans-serif; }
  </style>
<link href="https://fonts.googleapis.com/css2?family=Exo+2&amp;display=swap" rel="stylesheet"/>
<style>
   .font-exo2 { font-family: "Exo 2", sans-serif; }
  </style>
<link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/flatpickr">
</script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/th.js">
</script>
</head>
<body class="bg-gray-100 font-sans">
<!-- Section 3: Contact -->
<!-- Footer -->
<footer class="bg-blue-900 text-white py-8">
<div class="max-w-6xl mx-auto px-4 grid grid-cols-1 sm:grid-cols-3 gap-8">
<!-- Left column -->
<div>
<img alt="iCARE+ Logo" class="h-12 mb-2" src="https://img2.pic.in.th/pic/loICARE08d2635f15818a2a.png"/>
<h3 class="font-bold text-lg text-base sm:text-lg md:text-xl">
      Latbualuang iCARE+
     </h3>
<p class="mt-1">
      ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏™‡πà‡πÉ‡∏à ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå
     </p>
<p class="italic text-sm mt-2">
      "CARE ‡∏Ñ‡∏∑‡∏≠ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå"
     </p>
<p class="mt-1">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏¢ ‡∏£‡∏≠‡∏á‡∏Ø ‡∏†‡∏±‡∏ó‡∏£‡∏°‡∏ì‡∏ë‡∏ô‡πå ‡∏õ‡∏≤‡∏ô‡∏°‡∏≠‡∏ç</p>
</div>
<!-- Center column -->
<div>
<h4 class="font-bold text-lg mb-2">
      ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πà‡∏ß‡∏ô
     </h4>
<ul>
<li class="mb-1">
<a class="hover:underline" href="#">
        ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
       </a>
</li>
<li>
<a class="hover:underline" href="#">
        ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
       </a>
</li>
</ul>
</div>
<!-- Right column -->
<div>
<h4 class="font-bold text-lg mb-2">
      ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
     </h4>
<p>
      üìû 035 379 190
     </p>
<p>
      üìß lpwicare.v2@gmail.com
     </p>
<p>
      ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡∏≤‡∏î‡∏ö‡∏±‡∏ß‡∏´‡∏•‡∏ß‡∏á‡πÑ‡∏û‡πÇ‡∏£‡∏à‡∏ô‡πå‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤
     </p>
<p>
      54/15 ‡∏´‡∏°‡∏π‡πà 5 ‡∏ï‡∏≥‡∏ö‡∏•‡∏û‡∏£‡∏∞‡∏¢‡∏≤‡∏ö‡∏±‡∏ô‡∏•‡∏∑‡∏≠
     </p>
<p>
      ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏•‡∏≤‡∏î‡∏ö‡∏±‡∏ß‡∏´‡∏•‡∏ß‡∏á ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤ 13230
     </p>
</div>
</div>
<div class="text-center text-sm text-gray-200 mt-8">
    ¬© 2023 Latbualuang iCARE+ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏™‡πà‡πÉ‡∏à ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå
   </div>
</footer>
<script>
   function togglePassword(id) {
  const input = document.getElementById(id);
  input.type = input.type === "password" ? "text" : "password";
}
  </script>
<!-- üö® Emergency Report Modal (Step 1: UI only) -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden p-4" id="emergencyModal">
<div class="bg-red-100 rounded-2xl shadow-2xl w-full max-w-md relative overflow-y-auto max-h-screen p-6 font-mitr">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="closeModal('emergencyModal')">
     ‚úñ
    </button>
<h2 class="text-xl sm:text-2xl font-bold text-red-600 mb-4 text-center">
     üö®üÜò ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ôüö®
    </h2>
<p class="text-sm text-blue-700 mt-2 mb-2 font-mitr" id="reporterName">
 üë§ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏î‡∏¢: (‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á...)
</p>
<input id="ReportedBy" name="ReportedBy" type="hidden"/>
<form action="https://script.google.com/macros/s/AKfycbxLWBNIqSfa_88ONWAlsK-gNBLQZBVTOT4za3xWFANrZ-_6ZQgmtLD4VB4NlXo2Y6ZD/exec" class="space-y-3" enctype="multipart/form-data" id="emergencyForm" method="POST">
<!-- Displayed student info (to be filled in dynamically after login) -->
<!-- Emergency Type Dropdown -->
<div>
<label class="block text-sm">
       ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô:
      </label>
<select class="w-full px-3 py-2 rounded border text-black bg-white" id="emergencyType" name="EmergencyType" onchange="this.style.color='#000';" style="color:#60A5FA;">
<option disabled="" selected="" value="">
        -- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏ --
       </option>
<optgroup label="üî¥ ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢" style="background-color:#fecaca;">
<option style="background-color:#fee2e2;">
         üí• ‡∏û‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
        </option>
<option style="background-color:#fee2e2;">
         üëä ‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏ß‡∏¥‡∏ß‡∏≤‡∏ó / ‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Å‡∏±‡∏ô
        </option>
<option style="background-color:#fee2e2;">
         üò¢ ‡∏ñ‡∏π‡∏Å‡∏£‡∏±‡∏á‡πÅ‡∏Å / ‡∏ö‡∏π‡∏•‡∏•‡∏µ‡πà (Bullying)
        </option>
<option style="background-color:#fee2e2;">
         üö¨ ‡∏û‡∏ö‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î / ‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå / ‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà
        </option>
<option style="background-color:#fee2e2;">
         üìµ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÅ‡∏Å‡∏•‡πâ‡∏á‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
        </option>
</optgroup>
<optgroup label="üü† ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô" style="background-color:#fed7aa;">
<option style="background-color:#ffedd5;">
         ü§¢ ‡∏õ‡πà‡∏ß‡∏¢‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô / ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏° / ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ / ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å
        </option>
<option style="background-color:#ffedd5;">
         üß† ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á / ‡∏ß‡∏¥‡∏ï‡∏Å‡∏Å‡∏±‡∏á‡∏ß‡∏• / ‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå
        </option>
<option style="background-color:#ffedd5;">
         ü©π ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏ / ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° / ‡∏•‡∏∑‡πà‡∏ô‡∏•‡πâ‡∏°
        </option>
</optgroup>
<optgroup label="üü° ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà" style="background-color:#fef08a;">
<option style="background-color:#fef9c3;">
         üî• ‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ / ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÑ‡∏´‡∏°‡πâ / ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏•‡∏±‡∏î‡∏ß‡∏á‡∏à‡∏£
        </option>
<option style="background-color:#fef9c3;">
         ‚ö†Ô∏è ‡∏û‡∏ö‡∏Ñ‡∏ô‡πÅ‡∏õ‡∏•‡∏Å‡∏´‡∏ô‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏ö‡∏∏‡∏Å‡∏£‡∏∏‡∏Å‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </option>
<option style="background-color:#fef9c3;">
         üßØ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå / ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πà‡∏ô‡∏ä‡∏≥‡∏£‡∏∏‡∏î
        </option>
<option style="background-color:#fef9c3;">
         üö∂‚Äç‚ôÇÔ∏è ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏≤‡∏¢‡∏ï‡∏±‡∏ß / ‡πÄ‡∏î‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </option>
</optgroup>
<optgroup label="üü¢ ‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" style="background-color:#bbf7d0;">
<option style="background-color:#dcfce7;" value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)">
         üí¨ ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)
        </option>
</optgroup>
</select>
<input class="mt-2 w-full px-3 py-2 rounded border text-black hidden" id="otherEmergencyInput" name="OtherEmergencyDetail" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." type="text"/>
</div>
<!-- Location -->
<div>
<label class="block text-sm">
       ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏:
      </label>
<input class="w-full px-3 py-2 rounded border text-black" name="Location" required="" type="text"/>
</div>
<!-- File Uploads -->
<div>
<label class="block text-sm text-black">
       ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="imageFile" accept="image/*"/>
<label class="block text-sm mt-2 text-black" style="color:#000 !important;">
       ‡πÅ‡∏ô‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡πÄ‡∏™‡∏µ‡∏¢‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="audioFile" accept="audio/*"/>
<label class="block text-sm mt-2 text-black" style="color:#000 !important;">
       ‡πÅ‡∏ô‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):
      </label>
      <input class="w-full px-3 py-2 rounded border text-black" type="file" name="videoFile" accept="video/*"/>
<p class="text-xs text-gray-600 mt-1">
       ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏ß‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB
      </p>
</div>
<!-- Confirmation -->
<label class="inline-flex items-start text-sm text-gray-700">
<input class="mr-2 mt-1" required="" type="checkbox"/>
      ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ß‡πà‡∏≤ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£
     </label>
<p class="text-xs text-red-500 italic">
      üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô
     </p>
<!-- Submit -->
<div class="text-center pt-2">
<button class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded" type="submit">
       ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏
      </button>
<p class="text-sm mt-2" id="emergencyStatus">
</p>
</div>
</form>
</div>
</div>
<script>
   function toggleOtherInput(value) {
  const input = document.getElementById("otherEmergencyInput");
  input.classList.toggle("hidden", value !== "‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)");
}
  </script>
<!-- ‚úÖ New Login Modal -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" id="loginModal">
<div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-sm relative font-mitr">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="document.getElementById('loginModal').classList.add('hidden')">
     ‚úñ
    </button>
<h2 class="text-xl font-bold mb-4 text-yellow-600">
     üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
    </h2>
<form class="space-y-3" id="loginForm">
<input class="w-full px-3 py-2 rounded border" name="Username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required="" type="text"/>
<input class="w-full px-3 py-2 rounded border" name="Password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required="" type="password"/>
<button class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded" type="submit">
      ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
     </button>
<p class="text-center text-sm mt-2 text-red-600" id="loginStatus">
</p>
</form>
</div>
</div>
<!-- ‚úÖ Login Script -->
<script>
   const loginScriptURL = "https://script.google.com/macros/s/AKfycbw7X3QPSj76DJR9eelvRI73MGZIltO_WX1g2OdQ5RIAhfxs_6ecBwJZa6V_qImLctIHuA/exec";

  document.getElementById("loginForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const username = this.Username.value.trim();
    const password = this.Password.value.trim();
    const formData = new FormData();
    formData.append("Username", username);
    formData.append("username", username);
    formData.append("Password", password);
    formData.append("password", password);
    formData.append("IP_Address", "Auto");
    formData.append("ip", "Auto");
    formData.append("Device", navigator.userAgent);
    formData.append("device", navigator.userAgent);

    fetch(loginScriptURL, {
      method: "POST",
      body: formData,
    })
    .then((res) => res.json())
    .then((data) => {
      const ok = data && (data.success === true || data.status === 'success');
      if (ok) {
        sessionStorage.setItem("userData", JSON.stringify(data));
        document.getElementById("loginStatus").textContent = "‚úÖ üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        document.getElementById("loginModal").classList.add("hidden");
        enableProtectedFeatures(); if(window.onLoginSuccess){ try{ window.onLoginSuccess(); }catch(_){} }
alert(`‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${data.Prefix}${data.FirstName} ${data.LastName}`);
      } else {
        document.getElementById("loginStatus").textContent = "‚ùå " + data.message;
      }
    })
    .catch((err) => {
      document.getElementById("loginStatus").textContent = "‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message;
    });
  });

  function enableProtectedFeatures() {
    const protectedButtons = document.querySelectorAll(".protected-button, .protected-form");
    protectedButtons.forEach(btn => {
      btn.disabled = false;
      btn.classList.remove("opacity-50", "pointer-events-none");
    });
  }

  window.onload = function () {
    const user = sessionStorage.getItem("userData");
    if (!user) {
      const protectedButtons = document.querySelectorAll(".protected-button, .protected-form");
      protectedButtons.forEach(btn => {
        btn.disabled = true;
        btn.classList.add("opacity-50", "pointer-events-none");
      });
    } else {
      enableProtectedFeatures(); if(window.onLoginSuccess){ try{ window.onLoginSuccess(); }catch(_){} }
}
  };
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll("select option").forEach(opt => {
    const text = opt.textContent.trim();
    if (["‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢", "‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á", "‡∏ô‡∏≤‡∏¢", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", "-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --"].includes(text)) {
      opt.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll("select option").forEach(opt => {
    const text = opt.textContent.trim();
    if (text) {
      opt.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  const placeholders = ["‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤", "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô", "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];
  document.querySelectorAll("input[placeholder], select[placeholder]").forEach(el => {
    if (placeholders.includes(el.placeholder.trim())) {
      el.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  const targets = ["-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --", "-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --", "-- ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];

  // Set color for placeholder-like options in select dropdowns
  document.querySelectorAll("select option").forEach(option => {
    if (targets.includes(option.textContent.trim())) {
      option.style.color = "#60A5FA";
    }
  });

  // Set color for placeholder in input fields
  document.querySelectorAll("input[placeholder]").forEach(input => {
    if (targets.includes(input.placeholder.trim())) {
      input.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   document.addEventListener("DOMContentLoaded", function () {
  const blueOptions = ["-- ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ --", "-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --", "-- ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --", "‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ"];
  document.querySelectorAll("select option").forEach(opt => {
    if (blueOptions.includes(opt.textContent.trim())) {
      opt.style.color = "#60A5FA";
    }
  });
});
  </script>
<script>
   flatpickr("#birthdate", {
    dateFormat: "d/m/Y",
    locale: "th",
    allowInput: true
  });
  </script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const photoInput = document.getElementById("TeacherPhoto");
  const statusDiv = document.getElementById("teacherFormMessage");

  if (photoInput) {
    photoInput.addEventListener("change", function () {
      const file = this.files[0];
      if (file && file.size > 1024 * 1024) {
        statusDiv.textContent = "‚ùå ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1MB";
        statusDiv.className = "text-red-600";
        this.value = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤
      } else {
        statusDiv.textContent = "";
        statusDiv.className = "";
      }
    });
  }
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const user = JSON.parse(sessionStorage.getItem("userData") || "{}");

  const fullName = `${user.Prefix || ""}${user.FirstName || ""} ${user.LastName || ""}`.trim();
  const classroom = user.Class && user.Room ? ` ‡∏°.${user.Class}/${user.Room}` : "";
  const displayName = fullName + classroom;

  // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô UI
  const display = document.getElementById("reporterName");
  if (display) {
    display.textContent = "üë§ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏î‡∏¢: " + displayName;
  }

  // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤ hidden input ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÉ‡∏ô Google Sheet
  const input = document.getElementById("ReportedBy");
  if (input) {
    input.value = displayName;
  }
});
</script>

<!-- üìû iCARE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠ Modal -->
<div class="fixed z-50 inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden p-4" id="icareListenModal">
<div class="bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto p-6 font-mitr relative">
<button class="absolute top-2 right-2 text-gray-600 hover:text-black" onclick="document.getElementById('icareListenModal').classList.add('hidden')">‚úñ</button>
<h2 class="text-2xl font-bold text-center mb-4 text-green-600">üìû iCARE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠</h2>
<form class="space-y-4" id="icareListenForm">
<div>
<label class="block text-sm font-mitr" for="icareReason" style="color:#60D9A3;">‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</label>
<select class="w-full px-3 py-2 rounded border text-black bg-white font-mitr" id="icareReason" name="icareReason" onchange="this.style.color='#000';" required="" style="color:#60D9A3;">
<option disabled="" selected="" value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• --</option>
<option>üòä ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏Ñ‡∏£‡∏™‡∏±‡∏Å‡∏Ñ‡∏ô‡∏ü‡∏±‡∏á (‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ ‡πÅ‡∏Ñ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πá‡∏û‡∏≠‡πÅ‡∏•‡πâ‡∏ß)</option>
<option>üë©‚Äçüè´ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</option>
<option>üìû ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö (‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ)</option>
<option>ü§ù ‡∏≠‡∏¢‡∏≤‡∏Å‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á (‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡∏≤‡∏ö‡πâ‡∏≤‡∏á ‡∏Å‡πá‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ô‡∏≠‡∏∞)</option>
<option>üë®‚Äçüíº ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏• (‡∏ö‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠)</option>
<option>‚úçÔ∏è ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)</option>
</select>
</div>
<div>
<label class="block text-sm text-gray-700 font-mitr" for="icareDetails">‚úçÔ∏è ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
<textarea class="w-full px-3 py-2 rounded border text-black font-mitr min-h-[150px]" id="icareDetails" name="icareDetails" placeholder="" rows="6" style="resize: none;" required=""></textarea>
</div>
<p class="text-sm text-gray-600 mt-2 font-mitr">üîê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
<p class="text-sm text-green-600 italic font-mitr">üôè ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏à üíõ ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏û‡∏±‡∏á ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏™‡∏°‡∏≠</p>
<div class="text-center">
<button class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded font-mitr" style="width: auto;" type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
<p class="text-sm mt-2 font-mitr" id="icareListenStatus"></p>
</div>
</form>
</div>
</div>
<script>
  document.getElementById("icareListenForm")?.addEventListener("submit", function (e) {
    e.preventDefault();
    const status = document.getElementById("icareListenStatus");
    status.textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
    status.className = "text-green-600";
    this.reset();
  });
</script>
<!-- Emotion Assessment Modal -->
<script>
function showEmotionModal() {
  const modal = document.getElementById("emotionModal");
  if (modal) {
    modal.style.display = "flex";
  }
}

function hideEmotionModal() {
  const modal = document.getElementById("emotionModal");
  if (modal) {
    modal.style.display = "none";
  }
}

window.addEventListener("click", function (event) {
  const modal = document.getElementById("emotionModal");
  if (event.target === modal) {
    hideEmotionModal();
  }
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const form = document.getElementById("studentForm");
  if (!form) return;

  // Mark all relevant fields as required
  const fields = form.querySelectorAll("input, select, textarea");
  fields.forEach(el => {
    const type = (el.getAttribute("type") || "").toLowerCase();
    if (["button","submit","reset","file"].includes(type)) return;
    el.setAttribute("required", "required");
  });
});

function listMissingFields(form) {
  const missing = [];
  const controls = form.querySelectorAll("input[required], select[required], textarea[required]");

  controls.forEach(el => {
    const type = (el.getAttribute("type") || "").toLowerCase();
    if (type === "checkbox" || type === "radio") {
      const group = form.querySelectorAll(`input[name="${el.name}"][type="${type}"]`);
      const anyChecked = Array.from(group).some(i => i.checked);
      if (!anyChecked) {
        const label = form.querySelector(`label[for="${el.id}"]`);
        missing.push((label && label.textContent.trim()) || el.placeholder || el.name || "(‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≠‡∏á)");
      }
    } else {
      if (!el.value || el.value.trim() === "") {
        const label = form.querySelector(`label[for="${el.id}"]`);
        missing.push((label && label.textContent.trim()) || el.placeholder || el.name || "(‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≠‡∏á)");
      }
    }
  });
  return missing;
}

// Override validateForm to enforce required fields and show messages
(function() {
  const POST_URL = "https://script.google.com/macros/s/AKfycbzSeGx-6y5vgurpk1ZUvqY-rJOoJpH-swbX3yes86GIaxyZqZOftOvULYUzx9PTZ6c7/exec";
  const _orig = window.validateForm;

  window.validateForm = function(event) {
    event.preventDefault();
    const form = event.target;
    const message = document.getElementById("formMessage");
    if (message) { message.textContent = ""; message.className = "mt-2 text-sm"; }

    // 1) Check required
    const missing = listMissingFields(form);
    if (missing.length > 0) {
      const text = "‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á";
      if (message) {
        message.textContent = text;
        message.className = "mt-2 text-sm text-red-600";
      }
      return false; // block submission
    }

    // 2) Check password confirmation if present
    if (form.Password && form.ConfirmPassword && form.Password.value !== form.ConfirmPassword.value) {
      if (message) {
        message.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô";
        message.className = "mt-2 text-sm text-red-600";
      }
      return false;
    }

    // 3) Submit
    const formData = new FormData(form);
    fetch(POST_URL, { method: "POST", body: formData })
      .then(async (res) => {
        if (res.ok) {
          if (message) {
            message.textContent = "‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
            message.className = "mt-2 text-sm text-green-600";
          }
          form.reset();
        } else {
          const t = await res.text().catch(()=>"");
          if (message) {
            message.textContent = "‚ùå ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (t || ("HTTP " + res.status));
            message.className = "mt-2 text-sm text-red-600";
          }
        }
      })
      .catch(err => {
        if (message) {
          message.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: " + err.message;
          message.className = "mt-2 text-sm text-red-600";
        }
      });

    return false;
  };
})();
</script>

<script>
// --- Emergency form wiring (validation + submit to GAS) ---
(function() {
  const form = document.getElementById("emergencyForm");
  if (!form) return;
  let statusEl = document.getElementById("emergencyStatus");
  if (!statusEl) { statusEl = document.createElement("p"); statusEl.id = "emergencyStatus"; statusEl.className = "text-sm mt-2"; form.appendChild(statusEl); }
  const typeSel = document.getElementById("emergencyType") || form.querySelector('[name="EmergencyType"], select[name="emergencyType"]');
  const locInput = form.querySelector('[name="Location"], #Location, input[name="location"]');
  const confirmBox = form.querySelector('input[type="checkbox"]');
  const otherInput = document.getElementById('otherEmergencyInput');

  if (typeSel && otherInput) {
    typeSel.addEventListener('change', function() {
      const show = (String(this.value||'').trim() === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)');
      otherInput.classList.toggle('hidden', !show);
      if (!show) otherInput.value = "";
    });
  }

  async function lookupStudentContext(username) {
    try {
      if (typeof loginScriptURL !== "string" || !loginScriptURL) return null;
      const params = new URLSearchParams(); params.append("action","lookup"); params.append("Username", username);
      const res = await fetch(loginScriptURL, { method: "POST", body: params });
      if (!res.ok) return null;
      const ct = res.headers.get("content-type")||"";
      if (ct.includes("application/json")) {
        const j = await res.json().catch(()=>null); return j && (j.data || j);
      } else { try { return JSON.parse(await res.text()); } catch(_) { return null; } }
    } catch(_) { return null; }
  }

  form.addEventListener("submit", async function(e) {
    e.preventDefault();
    statusEl.textContent = ""; statusEl.className = "text-sm mt-2";

    const typeVal = typeSel ? String(typeSel.value||"").trim() : "";
    const locVal  = locInput ? String(locInput.value||"").trim() : "";
    const agreed  = !!(confirmBox && confirmBox.checked);
    if (!typeVal) { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô"; statusEl.classList.add("text-red-600"); return; }
    if (!locVal)  { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏"; statusEl.classList.add("text-red-600"); return; }
    if (!agreed)  { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡πä‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£"; statusEl.classList.add("text-red-600"); return; }

    // size check <= 5MB
    const _fileInputs = form.querySelectorAll('input[type="file"]');
    let _totalBytes = 0; _fileInputs.forEach(inp => { Array.from(inp.files||[]).forEach(f => { _totalBytes += (f && f.size) ? f.size : 0; }); });
    if (_totalBytes > 5 * 1024 * 1024) { statusEl.textContent="‚ùå ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 5MB"; statusEl.classList.add("text-red-600"); return; }

    let session = null; try { session = JSON.parse(sessionStorage.getItem("userData") || "null"); } catch(_){}
    if (!session) { statusEl.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏"; statusEl.classList.add("text-red-600"); return; }
    const usr = session && session.data ? session.data : session;
    const username = usr && (usr.Username || usr.username);
    if (!username) { statusEl.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà"; statusEl.classList.add("text-red-600"); return; }

    const fd = new FormData(form);
    fd.append("Username", username);

    let ctx = {
      StudentID: usr.StudentID,
      Prefix_Student: usr.Prefix_Student || usr.Prefix,
      FirstName_Student: usr.FirstName_Student || usr.FirstName,
      LastName_Student: usr.LastName_Student || usr.LastName,
      Class: usr.Class, Room: usr.Room, StudentPhone: usr.StudentPhone || usr.Phone
    };
    if (!ctx.StudentID || !ctx.FirstName_Student || !ctx.LastName_Student) {
      const looked = await lookupStudentContext(username);
      if (looked) {
        ctx.StudentID = ctx.StudentID || looked.StudentID || looked.studentId || "";
        ctx.Prefix_Student = ctx.Prefix_Student || looked.Prefix_Student || looked.Prefix || "";
        ctx.FirstName_Student = ctx.FirstName_Student || looked.FirstName_Student || looked.FirstName || "";
        ctx.LastName_Student  = ctx.LastName_Student  || looked.LastName_Student  || looked.LastName  || "";
        ctx.Class = ctx.Class || looked.Class || "";
        ctx.Room  = ctx.Room  || looked.Room  || "";
        ctx.StudentPhone = ctx.StudentPhone || looked.StudentPhone || looked.Phone || "";
      }
    }
    Object.keys(ctx).forEach(k => { if (ctx[k]) fd.append(k, String(ctx[k])); });

    fd.append("IP_Address","Auto"); fd.append("Device", navigator.userAgent); fd.append("Source","EmergencyForm");

    const url = form.action || "https://script.google.com/macros/s/AKfycbxLWBNIqSfa_88ONWAlsK-gNBLQZBVTOT4za3xWFANrZ-_6ZQgmtLD4VB4NlXo2Y6ZD/exec";
    try {
      const res = await fetch(url, { method:"POST", body: fd });
      const txt = await res.text().catch(()=> "");
      if (res.ok) {
        statusEl.textContent = "‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"; statusEl.classList.add("text-green-600");
        if (typeSel) typeSel.value=""; if (locInput) locInput.value=""; if (otherInput) { otherInput.value=""; otherInput.classList.add("hidden"); } if (confirmBox) confirmBox.checked=false;
      } else {
        statusEl.textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (txt || res.status); statusEl.classList.add("text-red-600");
      }
    } catch(err) {
      statusEl.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: " + err.message; statusEl.classList.add("text-red-600");
    }
  });
})();
</script>

<script>window.loginScriptURL="https://script.google.com/macros/s/AKfycbytXOkLNA8p-uIJI53L0xGzkOu8f76VSf5pj5kdCH5y7llpgEIQ8zm9rqHoNaxyzi937A/exec";</script>
<script>

(function(){
  const form = document.getElementById("icareListenForm");
  if (!form) return;

  // Add hidden iframe fallback target
  let iframe = document.getElementById("listenHiddenFrame");
  if (!iframe) {
    iframe = document.createElement("iframe");
    iframe.style.display = "none";
    iframe.id = "listenHiddenFrame";
    document.body.appendChild(iframe);
  }

  const statusEl = document.getElementById("icareListenStatus");
  const setStatus = (msg, ok)=>{
    if (!statusEl) return;
    statusEl.textContent = msg || "";
    statusEl.classList.remove("text-red-600","text-green-600");
    statusEl.classList.add(ok ? "text-green-600":"text-red-600");
  };

  function getValByPref(ids, names){
    for (const id of (ids||[])) {
      const el = document.getElementById(id);
      if (el && typeof el.value !== "undefined") return String(el.value||"").trim();
    }
    for (const nm of (names||[])) {
      const el = form.querySelector(`[name="${nm}"]`);
      if (el && typeof el.value !== "undefined") return String(el.value||"").trim();
    }
    return "";
  }

  form.addEventListener("submit", async function(e){
    e.preventDefault();
    e.stopImmediatePropagation();
    setStatus("", true);

    if (form.dataset.submitting === "1") return;
    form.dataset.submitting = "1";
    const submitBtn = form.querySelector('[type="submit"]');
    if (submitBtn) submitBtn.disabled = true;

    try {
      // Validate required fields in the form generically
      const requiredEls = form.querySelectorAll("[required]");
      for (const el of requiredEls) {
        if (!el.value || String(el.value).trim() === "") {
          setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á", false);
          if (submitBtn) submitBtn.disabled = false;
          form.dataset.submitting = "0";
          return;
        }
      }

      // Session / login data
      let sess = null;
      try { sess = JSON.parse(sessionStorage.getItem("userData") || "null"); } catch(_){}
      if (!sess) { try { sess = JSON.parse(localStorage.getItem("userData") || "null"); } catch(_){ } }
      if (!sess) { try { sess = JSON.parse(localStorage.getItem("studentData") || "null"); } catch(_){ } }

      const user = (sess && sess.data) ? sess.data : sess;
      const username = user && (user.Username || user.username);
      if (!username) {
        setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", false);
        if (submitBtn) submitBtn.disabled = false;
        form.dataset.submitting = "0";
        return;
      }

      // Gather values (support multiple DOM names/ids)
      const reason  = getValByPref(["icareReason"], ["ListenReason","reason"]);
      const details = getValByPref(["icareDetails"],["ListenDetails","details"]);
      if (!reason)  { setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£", false);  submitBtn && (submitBtn.disabled=false); form.dataset.submitting="0"; return; }
      if (!details) { setStatus("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°", false); submitBtn && (submitBtn.disabled=false); form.dataset.submitting="0"; return; }

      // Build payload
      const fd = new FormData();
      const rid = (crypto.randomUUID ? crypto.randomUUID() : Date.now().toString(36)+Math.random().toString(36).slice(2));
      fd.append("RequestID", rid);
      fd.append("Username", username);
      fd.append("ListenReason", reason);
      fd.append("ListenDetails", details);
      fd.append("Source", "ListenForm");
      fd.append("IP_Address", "Auto");
      fd.append("Device", navigator.userAgent);

      // pass student context if present
      const ctx = {
        StudentID: user && user.StudentID,
        Prefix_Student: (user && (user.Prefix_Student || user.Prefix)),
        FirstName_Student: (user && (user.FirstName_Student || user.FirstName)),
        LastName_Student:  (user && (user.LastName_Student  || user.LastName)),
        Class: user && user.Class,
        Room:  user && user.Room,
        StudentPhone: user && (user.StudentPhone || user.Phone)
      };
      Object.keys(ctx).forEach(k => { if (ctx[k]) fd.append(k, String(ctx[k])); });

      const ENDPOINT = "https://script.google.com/macros/s/AKfycbzejn_sGgjDfOYU5nNtOV8hsgESSL0Pc7747Da5kGjwJXhiGzkse13WBliJY9iSy8GV/exec";

      // Try normal fetch first
      let ok = false, txt = "";
      try {
        const resp = await fetch(ENDPOINT, { method: "POST", body: fd });
        txt = await resp.text().catch(()=> "");
        ok = resp.ok || (txt && /‚úÖ/.test(txt));
      } catch (err) {
        // ignore, will fallback
      }

      if (!ok) {
        // Hidden iframe fallback (classic HTML POST) to beat CORS/network oddities
        const tempForm = document.createElement("form");
        tempForm.action = ENDPOINT;
        tempForm.method = "POST";
        tempForm.enctype = "multipart/form-data";
        tempForm.target = "listenHiddenFrame";
        tempForm.style.display = "none";

        const add = (k,v)=>{
          const inp = document.createElement("input");
          inp.type = "hidden"; inp.name = k; inp.value = v;
          tempForm.appendChild(inp);
        };
        add("RequestID", rid);
        add("Username", username);
        add("ListenReason", reason);
        add("ListenDetails", details);
        add("Source", "ListenForm");
        add("IP_Address", "Auto");
        add("Device", navigator.userAgent);
        Object.keys(ctx).forEach(k => { if (ctx[k]) add(k, String(ctx[k])); });

        document.body.appendChild(tempForm);
        tempForm.submit();
        setTimeout(()=> { document.body.removeChild(tempForm); }, 2000);
        ok = true; // will rely on GAS idempotency
      }

      if (ok) {
        setStatus("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", true);
        form.reset();
      } else {
        setStatus("‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à " + (txt ? (": " + txt) : ""), false);
      }

    } catch (err) {
      setStatus("‚ùå ‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á: " + (err && err.message ? err.message : err), false);
    } finally {
      form.dataset.submitting = "0";
      const submitBtn2 = form.querySelector('[type="submit"]');
      if (submitBtn2) submitBtn2.disabled = false;
    }
  });
})();

</script>
</body>
</html>